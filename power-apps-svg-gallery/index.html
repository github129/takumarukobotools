<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Power Apps SVG Gallery | たく丸工房</title>
    <meta name="description" content="Power Appsで使えるSVGグラフやカードのサンプル集。コピペですぐに使える実用的なSVGコードを提供。カスタマイズも自由自在。">
    <meta property="og:title" content="Power Apps SVG Gallery | たく丸工房">
    <meta property="og:description" content="Power Appsで使えるSVGグラフ・カードのサンプル集">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tools.takumarukobo.com/power-apps-svg-gallery/">

    <link rel="icon" type="image/png" href="../logo.png">
    <link rel="apple-touch-icon" href="../logo.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0" />

    <style>
        body {
            font-family: 'Inter', 'Noto Sans JP', sans-serif;
            background-color: #F5F5F7;
            color: #1D1D1F;
        }
        html { scroll-behavior: smooth; }

        .material-symbols-rounded {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }

        .svg-card {
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        .svg-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 24px -8px rgba(0,0,0,0.15);
        }

        .category-tag {
            transition: all 0.2s ease;
        }

        .category-tag.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.show {
            display: flex;
        }

        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 13px;
            line-height: 1.6;
        }
    </style>
</head>
<body class="antialiased">

    <!-- ナビゲーションバー -->
    <nav class="fixed top-0 w-full z-50 bg-white/70 backdrop-blur-xl border-b border-gray-200/50 transition-all duration-300">
        <div class="max-w-7xl mx-auto px-6 h-14 flex items-center justify-between">
            <div class="flex items-center gap-2">
                <div class="w-8 h-8 rounded-lg overflow-hidden shadow-sm">
                    <img src="../logo.png" alt="たく丸工房 Logo" class="w-full h-full object-cover">
                </div>
                <span class="font-semibold tracking-tight text-gray-900">たく丸工房 Tools</span>
            </div>
            <div class="hidden md:flex space-x-6 text-sm font-medium text-gray-500">
                <a href="../index.html" class="hover:text-gray-900 transition-colors">Tools</a>
                <a href="../about.html" class="hover:text-gray-900 transition-colors">About</a>
                <a href="https://takumarukobo.com/" target="_blank" class="hover:text-gray-900 transition-colors">Home</a>
            </div>
        </div>
    </nav>

    <!-- ヘッダー -->
    <section class="pt-32 pb-12 px-6 text-center max-w-5xl mx-auto">
        <span class="inline-flex items-center gap-1 py-1 px-3 rounded-full bg-white border border-gray-200 text-xs font-semibold text-indigo-600 mb-6 shadow-sm">
            <span class="material-symbols-rounded text-[16px]">palette</span> SVG Gallery
        </span>
        <h1 class="text-4xl md:text-5xl font-bold tracking-tight leading-tight mb-6 text-gray-900">
            Power Apps用<br class="md:hidden"><span class="text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 to-purple-600">SVGサンプル集</span>
        </h1>
        <p class="text-lg text-gray-500 font-normal leading-relaxed max-w-2xl mx-auto mb-8">
            ダッシュボード構築に必要なグラフ、KPIカード、インジケーターが30種類以上。<br>
            コピペですぐに使える、実用的なビジュアル要素が揃っています。
        </p>

        <!-- 検索バー -->
        <div class="max-w-xl mx-auto mb-8">
            <div class="relative">
                <span class="material-symbols-rounded absolute left-4 top-1/2 -translate-y-1/2 text-gray-400">search</span>
                <input
                    type="text"
                    id="searchInput"
                    placeholder="サンプルを検索..."
                    class="w-full pl-12 pr-4 py-3 rounded-2xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all bg-white shadow-sm"
                >
            </div>
        </div>

        <!-- カテゴリータグ -->
        <div class="flex flex-wrap gap-2 justify-center mb-6">
            <button class="category-tag active px-4 py-2 rounded-full text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200" data-category="all">
                すべて
            </button>
            <button class="category-tag px-4 py-2 rounded-full text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200" data-category="graph">
                グラフ
            </button>
            <button class="category-tag px-4 py-2 rounded-full text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200" data-category="card">
                KPIカード
            </button>
            <button class="category-tag px-4 py-2 rounded-full text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200" data-category="dashboard">
                ダッシュボード
            </button>
            <button class="category-tag px-4 py-2 rounded-full text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200" data-category="indicator">
                インジケーター
            </button>
        </div>

        <!-- 件数表示 -->
        <p class="text-sm text-gray-500">
            <span id="resultCount">0</span> 件のサンプル
        </p>
    </section>

    <!-- SVGギャラリー -->
    <section class="px-6 pb-32 max-w-7xl mx-auto">
        <div id="galleryGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- SVGカードがここに動的に生成されます -->
        </div>

        <!-- 検索結果なし -->
        <div id="noResults" class="hidden text-center py-20">
            <span class="material-symbols-rounded text-6xl text-gray-300 mb-4">search_off</span>
            <p class="text-gray-500 text-lg">該当するサンプルが見つかりませんでした</p>
        </div>
    </section>

    <!-- モーダル -->
    <div id="modal" class="modal">
        <div class="bg-white rounded-3xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto shadow-2xl">
            <div class="sticky top-0 bg-white border-b border-gray-200 px-8 py-6 flex items-center justify-between rounded-t-3xl">
                <div>
                    <h2 id="modalTitle" class="text-2xl font-bold text-gray-900 mb-1">サンプル名</h2>
                    <p id="modalCategory" class="text-sm text-gray-500">カテゴリー</p>
                </div>
                <button onclick="closeModal()" class="text-gray-400 hover:text-gray-600 transition-colors">
                    <span class="material-symbols-rounded text-[32px]">close</span>
                </button>
            </div>

            <div class="p-8">
                <!-- プレビュー -->
                <div class="mb-8">
                    <h3 class="text-sm font-semibold text-gray-700 mb-4 uppercase tracking-wide">プレビュー</h3>
                    <div class="bg-gradient-to-br from-gray-50 to-gray-100 rounded-2xl p-12 flex items-center justify-center min-h-[300px]">
                        <div id="modalPreview" class="w-full max-w-md"></div>
                    </div>
                </div>

                <!-- 説明 -->
                <div class="mb-8">
                    <h3 class="text-sm font-semibold text-gray-700 mb-3 uppercase tracking-wide">説明</h3>
                    <p id="modalDescription" class="text-gray-600 leading-relaxed"></p>
                </div>

                <!-- SVGコード -->
                <div class="mb-8">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="text-sm font-semibold text-gray-700 uppercase tracking-wide">SVGコード</h3>
                        <button onclick="copySvgCode()" class="px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white text-sm font-medium rounded-lg transition-colors flex items-center gap-2">
                            <span class="material-symbols-rounded text-[18px]">content_copy</span>
                            コピー
                        </button>
                    </div>
                    <div class="code-block">
                        <pre id="modalCode"></pre>
                    </div>
                </div>

                <!-- Power Apps用コード -->
                <div>
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="text-sm font-semibold text-gray-700 uppercase tracking-wide">Power Apps用コード</h3>
                        <button onclick="copyPowerAppsCode()" class="px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white text-sm font-medium rounded-lg transition-colors flex items-center gap-2">
                            <span class="material-symbols-rounded text-[18px]">content_copy</span>
                            コピー
                        </button>
                    </div>
                    <div class="code-block">
                        <pre id="modalPowerAppsCode"></pre>
                    </div>
                    <p class="text-sm text-gray-500 mt-3">
                        <span class="material-symbols-rounded text-[16px] align-middle">info</span>
                        ImageコントロールのImageプロパティに貼り付けてください
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- フッター -->
    <footer class="border-t border-gray-200 bg-white py-12 px-6">
        <div class="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center gap-6">
            <div class="flex items-center gap-2">
                <div class="w-6 h-6 rounded overflow-hidden">
                    <img src="../logo.png" alt="たく丸工房 Logo" class="w-full h-full object-cover">
                </div>
                <p class="text-gray-500 text-sm">© 2025 Takumaru Kobo. All rights reserved.</p>
            </div>
            <div class="flex space-x-6">
                <a href="../about.html" class="text-gray-400 hover:text-gray-900 text-sm transition-colors">About</a>
                <a href="https://takumarukobo.com/page-152/" class="text-gray-400 hover:text-gray-900 text-sm transition-colors">お問い合わせ</a>
                <a href="https://x.com/taku_ma_ru" class="text-gray-400 hover:text-gray-900 text-sm transition-colors">X (Twitter)</a>
            </div>
        </div>
    </footer>

    <script>
        // SVGサンプルデータ
        const svgSamples = [
            {
                id: 1,
                title: "シンプル棒グラフ",
                category: "graph",
                description: "3つのデータを棒グラフで表示。色やサイズをカスタマイズ可能。月次比較や部門別データの表示に最適。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 200" width="300" height="200">
  <line x1="30" y1="0" x2="270" y2="0" stroke="#e5e7eb" stroke-width="1"/>
  <text x="25" y="12" text-anchor="end" font-size="10" fill="#999">100</text>
  <line x1="30" y1="45" x2="270" y2="45" stroke="#e5e7eb" stroke-width="1"/>
  <text x="25" y="49" text-anchor="end" font-size="10" fill="#999">75</text>
  <line x1="30" y1="90" x2="270" y2="90" stroke="#e5e7eb" stroke-width="1"/>
  <text x="25" y="94" text-anchor="end" font-size="10" fill="#999">50</text>
  <line x1="30" y1="135" x2="270" y2="135" stroke="#e5e7eb" stroke-width="1"/>
  <text x="25" y="139" text-anchor="end" font-size="10" fill="#999">25</text>
  <line x1="30" y1="180" x2="270" y2="180" stroke="#e5e7eb" stroke-width="1"/>
  <text x="25" y="184" text-anchor="end" font-size="10" fill="#999">0</text>
  <rect x="30" y="70" width="66" height="110" fill="#667eea" rx="4"/>
  <text x="63" y="195" text-anchor="middle" font-size="12" fill="#666">1月</text>
  <rect x="110" y="24" width="66" height="156" fill="#764ba2" rx="4"/>
  <text x="143" y="195" text-anchor="middle" font-size="12" fill="#666">2月</text>
  <rect x="190" y="92" width="66" height="88" fill="#f093fb" rx="4"/>
  <text x="223" y="195" text-anchor="middle" font-size="12" fill="#666">3月</text>
</svg>`
            },
            {
                id: 2,
                title: "円グラフ",
                category: "graph",
                description: "2色の円グラフ。パーセンテージ表示付き。中央のテキストもカスタマイズ可能。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200" width="200" height="200">
  <circle cx="100" cy="100" r="80" fill="#f0f0f0"/>
  <circle cx="100" cy="100" r="80" fill="none" stroke="#667eea" stroke-width="40" stroke-dasharray="377 377" stroke-dashoffset="94.25" transform="rotate(-90 100 100)"/>
  <text x="100" y="105" text-anchor="middle" font-size="32" font-weight="bold" fill="#667eea">75%</text>
</svg>`
            },
            {
                id: 3,
                title: "折れ線グラフ",
                category: "graph",
                description: "トレンドを示す折れ線グラフ。グラデーション背景付きで視認性抜群。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 150" width="300" height="150">
  <defs>
    <linearGradient id="lineGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#667eea;stop-opacity:0.3" />
      <stop offset="100%" style="stop-color:#667eea;stop-opacity:0" />
    </linearGradient>
  </defs>
  <line x1="20" y1="0" x2="280" y2="0" stroke="#e5e7eb" stroke-width="1"/>
  <text x="15" y="12" text-anchor="end" font-size="10" fill="#999">100</text>
  <line x1="20" y1="32.5" x2="280" y2="32.5" stroke="#e5e7eb" stroke-width="1"/>
  <text x="15" y="36.5" text-anchor="end" font-size="10" fill="#999">75</text>
  <line x1="20" y1="65" x2="280" y2="65" stroke="#e5e7eb" stroke-width="1"/>
  <text x="15" y="69" text-anchor="end" font-size="10" fill="#999">50</text>
  <line x1="20" y1="97.5" x2="280" y2="97.5" stroke="#e5e7eb" stroke-width="1"/>
  <text x="15" y="101.5" text-anchor="end" font-size="10" fill="#999">25</text>
  <line x1="20" y1="130" x2="280" y2="130" stroke="#e5e7eb" stroke-width="1"/>
  <text x="15" y="134" text-anchor="end" font-size="10" fill="#999">0</text>
  <polyline points="20,17 85,43 150,77 215,64 280,107" fill="none" stroke="#667eea" stroke-width="3"/>
  <polygon points="20,17 85,43 150,77 215,64 280,107 280,130 20,130" fill="url(#lineGrad)"/>
  <circle cx="20" cy="17" r="4" fill="#667eea"/>
  <circle cx="85" cy="43" r="4" fill="#667eea"/>
  <circle cx="150" cy="77" r="4" fill="#667eea"/>
  <circle cx="215" cy="64" r="4" fill="#667eea"/>
  <circle cx="280" cy="107" r="4" fill="#667eea"/>
</svg>`
            },
            {
                id: 5,
                title: "ステータスカード",
                category: "card",
                description: "プロジェクトやタスクのステータスを表示。アイコンと色でステータスを視覚化。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 120" width="300" height="120">
  <rect width="300" height="120" fill="#ffffff" rx="12" stroke="#e5e7eb" stroke-width="1"/>
  <circle cx="40" cy="60" r="20" fill="#10b981" opacity="0.1"/>
  <path d="M 35 60 L 38 63 L 45 56" stroke="#10b981" stroke-width="2" fill="none" stroke-linecap="round"/>
  <text x="75" y="55" font-size="16" fill="#1a1a1a" font-weight="600">プロジェクト完了</text>
  <text x="75" y="75" font-size="12" fill="#666">すべてのタスクが完了しました</text>
</svg>`
            },
            {
                id: 6,
                title: "情報カード",
                category: "card",
                description: "アイコン付きの情報カード。通知やお知らせの表示に最適。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 100" width="300" height="100">
  <rect width="300" height="100" fill="#eff6ff" rx="12"/>
  <rect x="0" y="0" width="6" height="100" fill="#3b82f6" rx="12"/>
  <circle cx="35" cy="50" r="12" fill="#3b82f6" opacity="0.2"/>
  <text x="35" y="55" font-size="16" fill="#3b82f6" font-weight="bold" text-anchor="middle">i</text>
  <text x="60" y="45" font-size="14" fill="#1a1a1a" font-weight="600">重要なお知らせ</text>
  <text x="60" y="65" font-size="12" fill="#666">システムメンテナンスを実施します</text>
</svg>`
            },
            {
                id: 7,
                title: "積み上げ棒グラフ",
                category: "graph",
                description: "複数のデータ系列を積み上げて表示。売上構成比や費用内訳の可視化に最適。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 200" width="300" height="200">
  <line x1="30" y1="20" x2="280" y2="20" stroke="#e5e7eb" stroke-width="1"/>
  <text x="25" y="32" text-anchor="end" font-size="10" fill="#999">150</text>
  <line x1="30" y1="60" x2="280" y2="60" stroke="#e5e7eb" stroke-width="1"/>
  <text x="25" y="64" text-anchor="end" font-size="10" fill="#999">112</text>
  <line x1="30" y1="100" x2="280" y2="100" stroke="#e5e7eb" stroke-width="1"/>
  <text x="25" y="104" text-anchor="end" font-size="10" fill="#999">75</text>
  <line x1="30" y1="140" x2="280" y2="140" stroke="#e5e7eb" stroke-width="1"/>
  <text x="25" y="144" text-anchor="end" font-size="10" fill="#999">37</text>
  <line x1="30" y1="180" x2="280" y2="180" stroke="#e5e7eb" stroke-width="1"/>
  <text x="25" y="192" text-anchor="end" font-size="10" fill="#999">0</text>
  <rect x="30" y="116" width="66" height="64" fill="#667eea"/>
  <path d="M 30,116 L 30,76 Q 30,72 34,72 L 92,72 Q 96,72 96,76 L 96,116 Z" fill="#764ba2"/>
  <text x="63" y="195" text-anchor="middle" font-size="11" fill="#666">Q1</text>
  <rect x="110" y="96" width="66" height="84" fill="#667eea"/>
  <path d="M 110,96 L 110,52 Q 110,48 114,48 L 172,48 Q 176,48 176,52 L 176,96 Z" fill="#764ba2"/>
  <text x="143" y="195" text-anchor="middle" font-size="11" fill="#666">Q2</text>
  <rect x="190" y="108" width="66" height="72" fill="#667eea"/>
  <path d="M 190,108 L 190,64 Q 190,60 194,60 L 252,60 Q 256,60 256,64 L 256,108 Z" fill="#764ba2"/>
  <text x="223" y="195" text-anchor="middle" font-size="11" fill="#666">Q3</text>
</svg>`
            },
            {
                id: 8,
                title: "面グラフ（エリアチャート）",
                category: "graph",
                description: "時系列データの推移を面で表現。売上トレンドやアクセス数の変化を視覚化。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 150" width="300" height="150">
  <defs>
    <linearGradient id="areaGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#10b981;stop-opacity:0.5" />
      <stop offset="100%" style="stop-color:#10b981;stop-opacity:0.05" />
    </linearGradient>
  </defs>
  <line x1="20" y1="0" x2="280" y2="0" stroke="#e5e7eb" stroke-width="1"/>
  <text x="15" y="12" text-anchor="end" font-size="10" fill="#999">100</text>
  <line x1="20" y1="33.75" x2="280" y2="33.75" stroke="#e5e7eb" stroke-width="1"/>
  <text x="15" y="37.75" text-anchor="end" font-size="10" fill="#999">75</text>
  <line x1="20" y1="67.5" x2="280" y2="67.5" stroke="#e5e7eb" stroke-width="1"/>
  <text x="15" y="71.5" text-anchor="end" font-size="10" fill="#999">50</text>
  <line x1="20" y1="101.25" x2="280" y2="101.25" stroke="#e5e7eb" stroke-width="1"/>
  <text x="15" y="105.25" text-anchor="end" font-size="10" fill="#999">25</text>
  <line x1="20" y1="135" x2="280" y2="135" stroke="#e5e7eb" stroke-width="1"/>
  <text x="15" y="139" text-anchor="end" font-size="10" fill="#999">0</text>
  <polygon points="20,13.5 63.3,34.5 106.7,55.5 150,45 193.3,75 236.7,63 280,85.5 280,135 20,135" fill="url(#areaGrad)"/>
  <polyline points="20,13.5 63.3,34.5 106.7,55.5 150,45 193.3,75 236.7,63 280,85.5" fill="none" stroke="#10b981" stroke-width="2.5"/>
  <circle cx="20" cy="13.5" r="3" fill="#10b981"/>
  <circle cx="63.3" cy="34.5" r="3" fill="#10b981"/>
  <circle cx="106.7" cy="55.5" r="3" fill="#10b981"/>
  <circle cx="150" cy="45" r="3" fill="#10b981"/>
  <circle cx="193.3" cy="75" r="3" fill="#10b981"/>
  <circle cx="236.7" cy="63" r="3" fill="#10b981"/>
  <circle cx="280" cy="85.5" r="3" fill="#10b981"/>
</svg>`
            },
            {
                id: 9,
                title: "半円ゲージ",
                category: "indicator",
                description: "達成率や満足度を半円ゲージで表示。スピードメーター風のデザイン。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 120" width="200" height="120">
  <defs>
    <linearGradient id="gaugeGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#ef4444" />
      <stop offset="50%" style="stop-color:#fbbf24" />
      <stop offset="100%" style="stop-color:#10b981" />
    </linearGradient>
  </defs>
  <path d="M 30 100 A 70 70 0 0 1 170 100" fill="none" stroke="#e5e7eb" stroke-width="20" stroke-linecap="round"/>
  <path d="M 30 100 A 70 70 0 0 1 140 40" fill="none" stroke="url(#gaugeGrad)" stroke-width="20" stroke-linecap="round"/>
  <circle cx="100" cy="100" r="8" fill="#667eea"/>
  <line x1="100" y1="100" x2="140" y2="45" stroke="#667eea" stroke-width="3" stroke-linecap="round"/>
  <text x="100" y="95" text-anchor="middle" font-size="24" font-weight="bold" fill="#1a1a1a">78%</text>
</svg>`
            },
            {
                id: 10,
                title: "スパークライン",
                category: "indicator",
                description: "コンパクトなトレンド表示。KPIカード内に埋め込んで使用できます。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 40" width="120" height="40">
  <polyline points="5,30 20,25 35,28 50,18 65,22 80,15 95,20 110,12" fill="none" stroke="#667eea" stroke-width="2"/>
  <circle cx="110" cy="12" r="3" fill="#667eea"/>
</svg>`
            },
            {
                id: 13,
                title: "ドーナツグラフ",
                category: "graph",
                description: "中央に数値を表示できるドーナツ型のグラフ。複数の値を同時に表示可能。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200" width="200" height="200">
  <circle cx="100" cy="100" r="70" fill="none" stroke="#f0f0f0" stroke-width="30"/>
  <circle cx="100" cy="100" r="70" fill="none" stroke="#667eea" stroke-width="30" stroke-dasharray="198 440" stroke-dashoffset="0" transform="rotate(-90 100 100)"/>
  <circle cx="100" cy="100" r="70" fill="none" stroke="#764ba2" stroke-width="30" stroke-dasharray="132 440" stroke-dashoffset="-198" transform="rotate(-90 100 100)"/>
  <circle cx="100" cy="100" r="70" fill="none" stroke="#f093fb" stroke-width="30" stroke-dasharray="110 440" stroke-dashoffset="-330" transform="rotate(-90 100 100)"/>
  <text x="100" y="95" text-anchor="middle" dominant-baseline="middle" font-size="28" font-weight="bold" fill="#1a1a1a">100</text>
  <text x="100" y="115" text-anchor="middle" dominant-baseline="middle" font-size="12" fill="#666">売上構成</text>
</svg>`
            },
            {
                id: 14,
                title: "円形プログレスリング",
                category: "indicator",
                description: "完了率を円形で表示。プロジェクト進捗やタスク達成率の可視化に。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 120" width="120" height="120">
  <circle cx="60" cy="60" r="50" fill="none" stroke="#f0f0f0" stroke-width="12"/>
  <circle cx="60" cy="60" r="50" fill="none" stroke="#667eea" stroke-width="12" stroke-dasharray="220 314" stroke-dashoffset="0" transform="rotate(-90 60 60)" stroke-linecap="round"/>
  <text x="60" y="65" text-anchor="middle" font-size="24" font-weight="bold" fill="#1a1a1a">70%</text>
</svg>`
            },
            {
                id: 16,
                title: "横棒グラフ",
                category: "graph",
                description: "横向きの棒グラフ。ランキングや比較データの表示に適しています。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 150" width="300" height="150">
  <rect x="80" y="10" width="180" height="33" fill="#667eea" rx="4"/>
  <text x="75" y="31.5" text-anchor="end" font-size="12" fill="#666">営業部</text>
  <text x="265" y="31.5" font-size="12" fill="#fff" font-weight="600">90</text>
  <rect x="80" y="53" width="140" height="33" fill="#764ba2" rx="4"/>
  <text x="75" y="74.5" text-anchor="end" font-size="12" fill="#666">開発部</text>
  <text x="225" y="74.5" font-size="12" fill="#fff" font-weight="600">70</text>
  <rect x="80" y="96" width="100" height="33" fill="#f093fb" rx="4"/>
  <text x="75" y="117.5" text-anchor="end" font-size="12" fill="#666">総務部</text>
  <text x="185" y="117.5" font-size="12" fill="#fff" font-weight="600">50</text>
</svg>`
            },
            {
                id: 17,
                title: "ミニKPIカード",
                category: "card",
                description: "コンパクトなKPI表示。複数並べてダッシュボードを構成できます。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 180 100" width="180" height="100">
  <rect width="180" height="100" fill="#ffffff" rx="12" stroke="#e5e7eb" stroke-width="1"/>
  <circle cx="30" cy="30" r="18" fill="#eff6ff"/>
  <text x="30" y="37" text-anchor="middle" font-size="20" fill="#3b82f6">$</text>
  <text x="65" y="30" font-size="11" fill="#666">売上高</text>
  <text x="20" y="70" font-size="28" fill="#1a1a1a" font-weight="bold">¥842K</text>
  <text x="20" y="88" font-size="11" fill="#10b981">↑ 12% 前月比</text>
</svg>`
            },
            {
                id: 18,
                title: "複数円グラフ比較",
                category: "graph",
                description: "2つの円グラフを並べて比較表示。前年比や目標との比較に。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 280 140" width="280" height="140">
  <circle cx="70" cy="70" r="50" fill="#f0f0f0"/>
  <circle cx="70" cy="70" r="50" fill="none" stroke="#667eea" stroke-width="25" stroke-dasharray="236 314" stroke-dashoffset="0" transform="rotate(-90 70 70)"/>
  <text x="70" y="75" text-anchor="middle" font-size="18" font-weight="bold" fill="#1a1a1a">75%</text>
  <text x="70" y="135" text-anchor="middle" font-size="11" fill="#666">2024年</text>
  <circle cx="210" cy="70" r="50" fill="#f0f0f0"/>
  <circle cx="210" cy="70" r="50" fill="none" stroke="#10b981" stroke-width="25" stroke-dasharray="267 314" stroke-dashoffset="0" transform="rotate(-90 210 70)"/>
  <text x="210" y="75" text-anchor="middle" font-size="18" font-weight="bold" fill="#1a1a1a">85%</text>
  <text x="210" y="135" text-anchor="middle" font-size="11" fill="#666">2025年</text>
</svg>`
            },
            {
                id: 19,
                title: "バッテリーインジケーター",
                category: "indicator",
                description: "残量や在庫レベルをバッテリー形式で表示。視覚的にわかりやすい。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 150 80" width="150" height="80">
  <rect x="20" y="25" width="100" height="30" fill="none" stroke="#e5e7eb" stroke-width="3" rx="4"/>
  <rect x="120" y="32" width="8" height="16" fill="#e5e7eb" rx="2"/>
  <rect x="24" y="29" width="68" height="22" fill="#10b981" rx="2"/>
  <text x="75" y="68" text-anchor="middle" font-size="14" fill="#666" font-weight="600">68%</text>
</svg>`
            },
            {
                id: 20,
                title: "温度計ゲージ",
                category: "indicator",
                description: "温度計風のゲージ。売上目標やリスクレベルの表示に。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 200" width="100" height="200">
  <rect x="40" y="20" width="20" height="130" fill="#f0f0f0" rx="10"/>
  <rect x="40" y="80" width="20" height="70" fill="#ef4444" rx="10"/>
  <circle cx="50" cy="165" r="20" fill="#ef4444"/>
  <text x="75" y="170" font-size="16" fill="#666" font-weight="600">HIGH</text>
  <line x1="65" y1="50" x2="72" y2="50" stroke="#999" stroke-width="2"/>
  <line x1="65" y1="90" x2="72" y2="90" stroke="#999" stroke-width="2"/>
  <line x1="65" y1="130" x2="72" y2="130" stroke="#999" stroke-width="2"/>
</svg>`
            },
            {
                id: 21,
                title: "ダッシュボードヘッダー",
                category: "dashboard",
                description: "4つのKPIを横並びで表示。ダッシュボードのトップに配置。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 80" width="400" height="80">
  <rect width="400" height="80" fill="#ffffff" rx="12" stroke="#e5e7eb" stroke-width="1"/>
  <text x="20" y="30" font-size="11" fill="#666">総売上</text>
  <text x="20" y="55" font-size="20" fill="#1a1a1a" font-weight="bold">¥2.4M</text>
  <line x1="100" y1="15" x2="100" y2="65" stroke="#e5e7eb" stroke-width="1"/>
  <text x="120" y="30" font-size="11" fill="#666">新規顧客</text>
  <text x="120" y="55" font-size="20" fill="#1a1a1a" font-weight="bold">342</text>
  <line x1="200" y1="15" x2="200" y2="65" stroke="#e5e7eb" stroke-width="1"/>
  <text x="220" y="30" font-size="11" fill="#666">契約率</text>
  <text x="220" y="55" font-size="20" fill="#1a1a1a" font-weight="bold">67%</text>
  <line x1="300" y1="15" x2="300" y2="65" stroke="#e5e7eb" stroke-width="1"/>
  <text x="320" y="30" font-size="11" fill="#666">満足度</text>
  <text x="320" y="55" font-size="20" fill="#1a1a1a" font-weight="bold">4.8</text>
</svg>`
            },
            {
                id: 24,
                title: "タスク進捗カード",
                category: "dashboard",
                description: "プロジェクトのタスク完了状況を表示。チーム管理に最適。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 120" width="300" height="120">
  <rect width="300" height="120" fill="#ffffff" rx="12" stroke="#e5e7eb" stroke-width="1"/>
  <text x="20" y="25" font-size="13" fill="#666" font-weight="600">プロジェクト進捗</text>
  <text x="20" y="55" font-size="11" fill="#999">完了タスク</text>
  <rect x="20" y="62" width="260" height="12" fill="#f0f0f0" rx="6"/>
  <rect x="20" y="62" width="182" height="12" fill="#10b981" rx="6"/>
  <text x="280" y="72" text-anchor="end" font-size="11" fill="#1a1a1a" font-weight="600">14/20</text>
  <circle cx="25" cy="95" r="4" fill="#10b981"/>
  <text x="35" y="99" font-size="11" fill="#666">完了: 14件</text>
  <circle cx="125" cy="95" r="4" fill="#667eea"/>
  <text x="135" y="99" font-size="11" fill="#666">進行中: 6件</text>
</svg>`
            },
            {
                id: 25,
                title: "レーダーチャート風",
                category: "graph",
                description: "5項目の評価を視覚化。スキル分析や製品評価に使用。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200" width="200" height="200">
  <polygon points="100,30 170,70 140,150 60,150 30,70" fill="none" stroke="#e5e7eb" stroke-width="1"/>
  <polygon points="100,50 145,80 120,135 80,135 55,80" fill="none" stroke="#d1d5db" stroke-width="1"/>
  <polygon points="100,80 110,95 105,110 95,110 90,95" fill="#667eea" fill-opacity="0.3" stroke="#667eea" stroke-width="2"/>
  <circle cx="100" cy="30" r="4" fill="#667eea"/>
  <circle cx="170" cy="70" r="4" fill="#667eea"/>
  <circle cx="140" cy="150" r="4" fill="#667eea"/>
  <circle cx="60" cy="150" r="4" fill="#667eea"/>
  <circle cx="30" cy="70" r="4" fill="#667eea"/>
  <text x="100" y="20" text-anchor="middle" font-size="10" fill="#666">品質</text>
  <text x="185" y="75" font-size="10" fill="#666">価格</text>
  <text x="150" y="170" font-size="10" fill="#666">デザイン</text>
  <text x="45" y="170" font-size="10" fill="#666">サポート</text>
  <text x="10" y="75" font-size="10" fill="#666">速度</text>
</svg>`
            },
            {
                id: 27,
                title: "ヒートマップ風カレンダー",
                category: "graph",
                description: "日々のアクティビティを色の濃さで表現。習慣トラッキングやコミット履歴の可視化に。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 230 90" width="230" height="90">
  <rect x="10" y="10" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="22" y="10" width="8" height="8" fill="#9be9a8" rx="2"/>
  <rect x="34" y="10" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="46" y="10" width="8" height="8" fill="#40c463" rx="2"/>
  <rect x="58" y="10" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="70" y="10" width="8" height="8" fill="#30a14e" rx="2"/>
  <rect x="82" y="10" width="8" height="8" fill="#9be9a8" rx="2"/>
  <rect x="94" y="10" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="106" y="10" width="8" height="8" fill="#40c463" rx="2"/>
  <rect x="118" y="10" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="130" y="10" width="8" height="8" fill="#9be9a8" rx="2"/>
  <rect x="142" y="10" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="154" y="10" width="8" height="8" fill="#40c463" rx="2"/>
  <rect x="166" y="10" width="8" height="8" fill="#30a14e" rx="2"/>
  <rect x="178" y="10" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="190" y="10" width="8" height="8" fill="#9be9a8" rx="2"/>
  <rect x="202" y="10" width="8" height="8" fill="#216e39" rx="2"/>
  <rect x="214" y="10" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="10" y="22" width="8" height="8" fill="#9be9a8" rx="2"/>
  <rect x="22" y="22" width="8" height="8" fill="#40c463" rx="2"/>
  <rect x="34" y="22" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="46" y="22" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="58" y="22" width="8" height="8" fill="#30a14e" rx="2"/>
  <rect x="70" y="22" width="8" height="8" fill="#9be9a8" rx="2"/>
  <rect x="82" y="22" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="94" y="22" width="8" height="8" fill="#40c463" rx="2"/>
  <rect x="106" y="22" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="118" y="22" width="8" height="8" fill="#9be9a8" rx="2"/>
  <rect x="130" y="22" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="142" y="22" width="8" height="8" fill="#30a14e" rx="2"/>
  <rect x="154" y="22" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="166" y="22" width="8" height="8" fill="#40c463" rx="2"/>
  <rect x="178" y="22" width="8" height="8" fill="#9be9a8" rx="2"/>
  <rect x="190" y="22" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="202" y="22" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="214" y="22" width="8" height="8" fill="#30a14e" rx="2"/>
  <rect x="10" y="34" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="22" y="34" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="34" y="34" width="8" height="8" fill="#40c463" rx="2"/>
  <rect x="46" y="34" width="8" height="8" fill="#9be9a8" rx="2"/>
  <rect x="58" y="34" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="70" y="34" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="82" y="34" width="8" height="8" fill="#40c463" rx="2"/>
  <rect x="94" y="34" width="8" height="8" fill="#9be9a8" rx="2"/>
  <rect x="106" y="34" width="8" height="8" fill="#30a14e" rx="2"/>
  <rect x="118" y="34" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="130" y="34" width="8" height="8" fill="#40c463" rx="2"/>
  <rect x="142" y="34" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="154" y="34" width="8" height="8" fill="#9be9a8" rx="2"/>
  <rect x="166" y="34" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="178" y="34" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="190" y="34" width="8" height="8" fill="#216e39" rx="2"/>
  <rect x="202" y="34" width="8" height="8" fill="#40c463" rx="2"/>
  <rect x="214" y="34" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="10" y="46" width="8" height="8" fill="#40c463" rx="2"/>
  <rect x="22" y="46" width="8" height="8" fill="#9be9a8" rx="2"/>
  <rect x="34" y="46" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="46" y="46" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="58" y="46" width="8" height="8" fill="#40c463" rx="2"/>
  <rect x="70" y="46" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="82" y="46" width="8" height="8" fill="#9be9a8" rx="2"/>
  <rect x="94" y="46" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="106" y="46" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="118" y="46" width="8" height="8" fill="#40c463" rx="2"/>
  <rect x="130" y="46" width="8" height="8" fill="#9be9a8" rx="2"/>
  <rect x="142" y="46" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="154" y="46" width="8" height="8" fill="#30a14e" rx="2"/>
  <rect x="166" y="46" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="178" y="46" width="8" height="8" fill="#40c463" rx="2"/>
  <rect x="190" y="46" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="202" y="46" width="8" height="8" fill="#9be9a8" rx="2"/>
  <rect x="214" y="46" width="8" height="8" fill="#40c463" rx="2"/>
  <rect x="10" y="58" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="22" y="58" width="8" height="8" fill="#30a14e" rx="2"/>
  <rect x="34" y="58" width="8" height="8" fill="#9be9a8" rx="2"/>
  <rect x="46" y="58" width="8" height="8" fill="#40c463" rx="2"/>
  <rect x="58" y="58" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="70" y="58" width="8" height="8" fill="#40c463" rx="2"/>
  <rect x="82" y="58" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="94" y="58" width="8" height="8" fill="#30a14e" rx="2"/>
  <rect x="106" y="58" width="8" height="8" fill="#40c463" rx="2"/>
  <rect x="118" y="58" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="130" y="58" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="142" y="58" width="8" height="8" fill="#40c463" rx="2"/>
  <rect x="166" y="58" width="8" height="8" fill="#9be9a8" rx="2"/>
  <rect x="178" y="58" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="190" y="58" width="8" height="8" fill="#40c463" rx="2"/>
  <rect x="202" y="58" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="214" y="58" width="8" height="8" fill="#9be9a8" rx="2"/>
  <rect x="10" y="70" width="8" height="8" fill="#9be9a8" rx="2"/>
  <rect x="22" y="70" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="34" y="70" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="46" y="70" width="8" height="8" fill="#30a14e" rx="2"/>
  <rect x="58" y="70" width="8" height="8" fill="#9be9a8" rx="2"/>
  <rect x="70" y="70" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="82" y="70" width="8" height="8" fill="#40c463" rx="2"/>
  <rect x="94" y="70" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="106" y="70" width="8" height="8" fill="#9be9a8" rx="2"/>
  <rect x="118" y="70" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="130" y="70" width="8" height="8" fill="#30a14e" rx="2"/>
  <rect x="142" y="70" width="8" height="8" fill="#9be9a8" rx="2"/>
  <rect x="154" y="70" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="166" y="70" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="178" y="70" width="8" height="8" fill="#30a14e" rx="2"/>
  <rect x="190" y="70" width="8" height="8" fill="#9be9a8" rx="2"/>
  <rect x="202" y="70" width="8" height="8" fill="#ebedf0" rx="2"/>
  <rect x="214" y="70" width="8" height="8" fill="#ebedf0" rx="2"/>
</svg>`
            },
            {
                id: 28,
                title: "統計サマリーカード",
                category: "card",
                description: "総数と変化率を表示。上昇/下降/変動なしの3種類のトレンド表示に対応。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 220 110" width="220" height="110">
  <rect width="220" height="110" fill="#ffffff" rx="12" stroke="#e5e7eb" stroke-width="1"/>
  <rect x="15" y="15" width="40" height="40" fill="#f0fdf4" rx="8"/>
  <text x="35" y="42" text-anchor="middle" font-size="24" fill="#10b981">↑</text>
  <text x="65" y="28" font-size="12" fill="#999">総アクセス数</text>
  <text x="65" y="55" font-size="26" fill="#1a1a1a" font-weight="bold">12.5K</text>
  <rect x="15" y="70" width="190" height="25" fill="#f9fafb" rx="6"/>
  <text x="22" y="86" font-size="11" fill="#666">前日比</text>
  <text x="198" y="86" text-anchor="end" font-size="11" fill="#10b981" font-weight="600">+8.3% (962)</text>
</svg>`
            },
            {
                id: 31,
                title: "集合縦棒グラフ",
                category: "graph",
                description: "複数シリーズを横並びで比較。月別の複数商品売上比較などに使用。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 200" width="300" height="200">
  <line x1="30" y1="20" x2="280" y2="20" stroke="#e5e7eb" stroke-width="1"/>
  <text x="25" y="32" text-anchor="end" font-size="10" fill="#999">90</text>
  <line x1="30" y1="60" x2="280" y2="60" stroke="#e5e7eb" stroke-width="1"/>
  <text x="25" y="64" text-anchor="end" font-size="10" fill="#999">68</text>
  <line x1="30" y1="100" x2="280" y2="100" stroke="#e5e7eb" stroke-width="1"/>
  <text x="25" y="104" text-anchor="end" font-size="10" fill="#999">45</text>
  <line x1="30" y1="140" x2="280" y2="140" stroke="#e5e7eb" stroke-width="1"/>
  <text x="25" y="144" text-anchor="end" font-size="10" fill="#999">23</text>
  <line x1="30" y1="180" x2="280" y2="180" stroke="#e5e7eb" stroke-width="1"/>
  <text x="25" y="184" text-anchor="end" font-size="10" fill="#999">0</text>
  <rect x="30" y="56" width="38" height="124" fill="#667eea" rx="3"/>
  <rect x="72" y="82" width="38" height="98" fill="#764ba2" rx="3"/>
  <text x="70" y="195" text-anchor="middle" font-size="11" fill="#666">Q1</text>
  <rect x="120" y="47" width="38" height="133" fill="#667eea" rx="3"/>
  <rect x="162" y="73" width="38" height="107" fill="#764ba2" rx="3"/>
  <text x="160" y="195" text-anchor="middle" font-size="11" fill="#666">Q2</text>
  <rect x="210" y="65" width="38" height="115" fill="#667eea" rx="3"/>
  <rect x="252" y="91" width="38" height="89" fill="#764ba2" rx="3"/>
  <text x="250" y="195" text-anchor="middle" font-size="11" fill="#666">Q3</text>
</svg>`
            },
            {
                id: 32,
                title: "100%積み上げ縦棒グラフ",
                category: "graph",
                description: "全体に対する比率を表示。構成比の時系列変化の可視化に。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 200" width="300" height="200">
  <line x1="30" y1="20" x2="280" y2="20" stroke="#e5e7eb" stroke-width="1"/>
  <text x="25" y="32" text-anchor="end" font-size="10" fill="#999">100%</text>
  <line x1="30" y1="60" x2="280" y2="60" stroke="#e5e7eb" stroke-width="1"/>
  <text x="25" y="64" text-anchor="end" font-size="10" fill="#999">75%</text>
  <line x1="30" y1="100" x2="280" y2="100" stroke="#e5e7eb" stroke-width="1"/>
  <text x="25" y="104" text-anchor="end" font-size="10" fill="#999">50%</text>
  <line x1="30" y1="140" x2="280" y2="140" stroke="#e5e7eb" stroke-width="1"/>
  <text x="25" y="144" text-anchor="end" font-size="10" fill="#999">25%</text>
  <line x1="30" y1="180" x2="280" y2="180" stroke="#e5e7eb" stroke-width="1"/>
  <text x="25" y="192" text-anchor="end" font-size="10" fill="#999">0%</text>
  <path d="M 50 92 V 24 Q 50 20 54 20 H 96 Q 100 20 100 24 V 92 H 50 Z" fill="#667eea"/>
  <rect x="50" y="92" width="50" height="48" fill="#764ba2"/>
  <rect x="50" y="140" width="50" height="40" fill="#f093fb"/>
  <path d="M 125 100 V 24 Q 125 20 129 20 H 171 Q 175 20 175 24 V 100 H 125 Z" fill="#667eea"/>
  <rect x="125" y="100" width="50" height="54" fill="#764ba2"/>
  <rect x="125" y="154" width="50" height="26" fill="#f093fb"/>
  <path d="M 200 110 V 24 Q 200 20 204 20 H 246 Q 250 20 250 24 V 110 H 200 Z" fill="#667eea"/>
  <rect x="200" y="110" width="50" height="36" fill="#764ba2"/>
  <rect x="200" y="146" width="50" height="34" fill="#f093fb"/>
  <text x="75" y="195" text-anchor="middle" font-size="11" fill="#666">1月</text>
  <text x="150" y="195" text-anchor="middle" font-size="11" fill="#666">2月</text>
  <text x="225" y="195" text-anchor="middle" font-size="11" fill="#666">3月</text>
</svg>`
            },
            {
                id: 33,
                title: "散布図",
                category: "graph",
                description: "2つの変数の相関関係を表示。売上と広告費の関係分析などに。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 200" width="300" height="200">
  <line x1="30" y1="180" x2="280" y2="180" stroke="#e5e7eb" stroke-width="2"/>
  <line x1="30" y1="180" x2="30" y2="20" stroke="#e5e7eb" stroke-width="2"/>
  <line x1="30" y1="20" x2="280" y2="20" stroke="#f0f0f0" stroke-width="1"/>
  <text x="25" y="32" text-anchor="end" font-size="10" fill="#999">90</text>
  <line x1="30" y1="60" x2="280" y2="60" stroke="#f0f0f0" stroke-width="1"/>
  <text x="25" y="64" text-anchor="end" font-size="10" fill="#999">68</text>
  <line x1="30" y1="100" x2="280" y2="100" stroke="#f0f0f0" stroke-width="1"/>
  <text x="25" y="104" text-anchor="end" font-size="10" fill="#999">45</text>
  <line x1="30" y1="140" x2="280" y2="140" stroke="#f0f0f0" stroke-width="1"/>
  <text x="25" y="144" text-anchor="end" font-size="10" fill="#999">23</text>
  <line x1="30" y1="180" x2="280" y2="180" stroke="#f0f0f0" stroke-width="1"/>
  <text x="25" y="184" text-anchor="end" font-size="10" fill="#999">0</text>
  <circle cx="56" cy="56" r="5" fill="#667eea"/>
  <circle cx="82" cy="73" r="5" fill="#667eea"/>
  <circle cx="108" cy="91" r="5" fill="#667eea"/>
  <circle cx="134" cy="102" r="5" fill="#667eea"/>
  <circle cx="160" cy="116" r="5" fill="#667eea"/>
  <circle cx="186" cy="133" r="5" fill="#667eea"/>
  <circle cx="212" cy="146" r="5" fill="#667eea"/>
  <circle cx="69" cy="47" r="5" fill="#764ba2"/>
  <circle cx="98" cy="68" r="5" fill="#764ba2"/>
  <circle cx="124" cy="85" r="5" fill="#764ba2"/>
  <circle cx="150" cy="97" r="5" fill="#764ba2"/>
  <circle cx="176" cy="111" r="5" fill="#764ba2"/>
  <circle cx="202" cy="125" r="5" fill="#764ba2"/>
  <circle cx="228" cy="138" r="5" fill="#764ba2"/>
</svg>`
            },
            {
                id: 34,
                title: "バブルチャート",
                category: "graph",
                description: "3次元データを可視化。X, Y, サイズで3つの指標を同時表示。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 200" width="300" height="200">
  <line x1="50" y1="170" x2="290" y2="170" stroke="#e5e7eb" stroke-width="2"/>
  <line x1="50" y1="170" x2="50" y2="40" stroke="#e5e7eb" stroke-width="2"/>
  <line x1="50" y1="40" x2="290" y2="40" stroke="#f0f0f0" stroke-width="1"/>
  <text x="45" y="52" text-anchor="end" font-size="10" fill="#999">90</text>
  <line x1="50" y1="72.5" x2="290" y2="72.5" stroke="#f0f0f0" stroke-width="1"/>
  <text x="45" y="76.5" text-anchor="end" font-size="10" fill="#999">68</text>
  <line x1="50" y1="105" x2="290" y2="105" stroke="#f0f0f0" stroke-width="1"/>
  <text x="45" y="109" text-anchor="end" font-size="10" fill="#999">45</text>
  <line x1="50" y1="137.5" x2="290" y2="137.5" stroke="#f0f0f0" stroke-width="1"/>
  <text x="45" y="141.5" text-anchor="end" font-size="10" fill="#999">23</text>
  <line x1="50" y1="170" x2="290" y2="170" stroke="#f0f0f0" stroke-width="1"/>
  <text x="45" y="174" text-anchor="end" font-size="10" fill="#999">0</text>
  <circle cx="92" cy="90" r="15" fill="#667eea" fill-opacity="0.6" stroke="#667eea" stroke-width="2"/>
  <circle cx="146" cy="115" r="25" fill="#764ba2" fill-opacity="0.6" stroke="#764ba2" stroke-width="2"/>
  <circle cx="200" cy="135" r="20" fill="#f093fb" fill-opacity="0.6" stroke="#f093fb" stroke-width="2"/>
  <circle cx="254" cy="151" r="28" fill="#4facfe" fill-opacity="0.6" stroke="#4facfe" stroke-width="2"/>
  <circle cx="113" cy="99" r="12" fill="#667eea" fill-opacity="0.6" stroke="#667eea" stroke-width="2"/>
  <circle cx="167" cy="122" r="18" fill="#764ba2" fill-opacity="0.6" stroke="#764ba2" stroke-width="2"/>
  <circle cx="221" cy="141" r="22" fill="#f093fb" fill-opacity="0.6" stroke="#f093fb" stroke-width="2"/>
</svg>`
            },
            {
                id: 35,
                title: "縦棒折れ線複合グラフ",
                category: "graph",
                description: "異なる指標を同時表示。売上（棒）と利益率（線）の組み合わせなど。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 200" width="300" height="200">
  <line x1="30" y1="20" x2="280" y2="20" stroke="#e5e7eb" stroke-width="1"/>
  <text x="25" y="32" text-anchor="end" font-size="10" fill="#999">75</text>
  <line x1="30" y1="60" x2="280" y2="60" stroke="#e5e7eb" stroke-width="1"/>
  <text x="25" y="64" text-anchor="end" font-size="10" fill="#999">56</text>
  <line x1="30" y1="100" x2="280" y2="100" stroke="#e5e7eb" stroke-width="1"/>
  <text x="25" y="104" text-anchor="end" font-size="10" fill="#999">38</text>
  <line x1="30" y1="140" x2="280" y2="140" stroke="#e5e7eb" stroke-width="1"/>
  <text x="25" y="144" text-anchor="end" font-size="10" fill="#999">19</text>
  <line x1="30" y1="180" x2="280" y2="180" stroke="#e5e7eb" stroke-width="1"/>
  <text x="25" y="184" text-anchor="end" font-size="10" fill="#999">0</text>
  <rect x="30" y="73" width="35" height="107" fill="#667eea" rx="4"/>
  <rect x="80" y="53" width="35" height="127" fill="#667eea" rx="4"/>
  <rect x="130" y="83" width="35" height="97" fill="#667eea" rx="4"/>
  <rect x="180" y="42" width="35" height="138" fill="#667eea" rx="4"/>
  <rect x="230" y="63" width="35" height="117" fill="#667eea" rx="4"/>
  <polyline points="47.5,73 97.5,98 147.5,91 197.5,107 247.5,100" fill="none" stroke="#f093fb" stroke-width="3"/>
  <circle cx="47.5" cy="73" r="5" fill="#f093fb" stroke="#fff" stroke-width="2"/>
  <circle cx="97.5" cy="98" r="5" fill="#f093fb" stroke="#fff" stroke-width="2"/>
  <circle cx="147.5" cy="91" r="5" fill="#f093fb" stroke="#fff" stroke-width="2"/>
  <circle cx="197.5" cy="107" r="5" fill="#f093fb" stroke="#fff" stroke-width="2"/>
  <circle cx="247.5" cy="100" r="5" fill="#f093fb" stroke="#fff" stroke-width="2"/>
  <text x="47.5" y="195" text-anchor="middle" font-size="11" fill="#666">1月</text>
  <text x="97.5" y="195" text-anchor="middle" font-size="11" fill="#666">2月</text>
  <text x="147.5" y="195" text-anchor="middle" font-size="11" fill="#666">3月</text>
  <text x="197.5" y="195" text-anchor="middle" font-size="11" fill="#666">4月</text>
  <text x="247.5" y="195" text-anchor="middle" font-size="11" fill="#666">5月</text>
</svg>`
            }
        ];

        let currentCategory = 'all';
        let currentSearchTerm = '';
        let currentSample = null;

        // ページ読み込み時に実行
        document.addEventListener('DOMContentLoaded', () => {
            renderGallery();
            setupEventListeners();
        });

        // イベントリスナーの設定
        function setupEventListeners() {
            // 検索
            document.getElementById('searchInput').addEventListener('input', (e) => {
                currentSearchTerm = e.target.value.toLowerCase();
                renderGallery();
            });

            // カテゴリータグ
            document.querySelectorAll('.category-tag').forEach(tag => {
                tag.addEventListener('click', (e) => {
                    document.querySelectorAll('.category-tag').forEach(t => t.classList.remove('active'));
                    e.target.classList.add('active');
                    currentCategory = e.target.dataset.category;
                    renderGallery();
                });
            });

            // モーダルの外側クリックで閉じる
            document.getElementById('modal').addEventListener('click', (e) => {
                if (e.target.id === 'modal') {
                    closeModal();
                }
            });
        }

        // ギャラリーの描画
        function renderGallery() {
            const grid = document.getElementById('galleryGrid');
            const noResults = document.getElementById('noResults');

            // フィルタリング
            let filteredSamples = svgSamples.filter(sample => {
                const matchesCategory = currentCategory === 'all' || sample.category === currentCategory;
                const matchesSearch = sample.title.toLowerCase().includes(currentSearchTerm) ||
                                     sample.description.toLowerCase().includes(currentSearchTerm);
                return matchesCategory && matchesSearch;
            });

            // 件数表示
            document.getElementById('resultCount').textContent = filteredSamples.length;

            // 結果なし表示
            if (filteredSamples.length === 0) {
                grid.innerHTML = '';
                noResults.classList.remove('hidden');
                return;
            }

            noResults.classList.add('hidden');

            // カード生成
            grid.innerHTML = filteredSamples.map(sample => `
                <div class="svg-card bg-white rounded-2xl p-6 border border-gray-200 shadow-sm cursor-pointer" onclick="openModal(${sample.id})">
                    <div class="bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-6 mb-4 flex items-center justify-center min-h-[200px]">
                        ${sample.svgCode}
                    </div>
                    <div class="mb-2">
                        <span class="inline-block px-3 py-1 bg-indigo-50 text-indigo-600 text-xs font-medium rounded-full mb-2">
                            ${getCategoryLabel(sample.category)}
                        </span>
                    </div>
                    <h3 class="text-lg font-bold text-gray-900 mb-2">${sample.title}</h3>
                    <p class="text-sm text-gray-500 leading-relaxed line-clamp-2">${sample.description}</p>
                    <div class="mt-4 flex items-center text-indigo-600 text-sm font-medium">
                        詳細を見る
                        <span class="material-symbols-rounded text-[18px] ml-1">arrow_forward</span>
                    </div>
                </div>
            `).join('');
        }

        // カテゴリーラベルの取得
        function getCategoryLabel(category) {
            const labels = {
                'graph': 'グラフ',
                'card': 'KPIカード',
                'dashboard': 'ダッシュボード',
                'indicator': 'インジケーター'
            };
            return labels[category] || category;
        }

        // モーダルを開く
        function openModal(id) {
            currentSample = svgSamples.find(s => s.id === id);
            if (!currentSample) return;

            document.getElementById('modalTitle').textContent = currentSample.title;
            document.getElementById('modalCategory').textContent = getCategoryLabel(currentSample.category);
            document.getElementById('modalDescription').textContent = currentSample.description;
            document.getElementById('modalPreview').innerHTML = currentSample.svgCode;
            document.getElementById('modalCode').textContent = currentSample.svgCode;

            // Power Apps用コード生成（With関数で変数化）
            let powerAppsCode = generatePowerAppsCode(id, currentSample.svgCode);
            document.getElementById('modalPowerAppsCode').textContent = powerAppsCode;

            document.getElementById('modal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        // Power Apps用コード生成関数（With関数で変数化）
        function generatePowerAppsCode(id, svgCode) {
            const cleanSvg = (code) => code.replace(/\n/g, '').replace(/\s+/g, ' ').replace(/>\s+</g, '><').replace(/"/g, "'").trim();

            // サンプルIDに応じてWith関数付きコードを生成
            switch(id) {
                case 1: // シンプル棒グラフ（ForAllで可変個数対応）
                    return `With(
    {
        data: Table(
            {idx: 1, value: 55, color: "#667eea", label: "1月"},
            {idx: 2, value: 78, color: "#764ba2", label: "2月"},
            {idx: 3, value: 44, color: "#f093fb", label: "3月"}
        ),
        gridLines: Table({level: 0}, {level: 25}, {level: 50}, {level: 75}, {level: 100})
    },
    With(
        {
            dataMaxValue: Max(data, value),
            maxHeight: 180
        },
        With(
            {
                stepSize: If(dataMaxValue <= 10, 5, If(dataMaxValue <= 50, 10, If(dataMaxValue <= 100, 25, 50)))
            },
            With(
                {
                    maxValue: Round(dataMaxValue + stepSize, If(stepSize >= 50, -2, If(stepSize >= 10, -1, 0)))
                },
                "data:image/svg+xml," & EncodeUrl(
                    "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 200' width='300' height='200'>" &
                    Concat(
                        gridLines,
                        With(
                            {
                                gridY: maxHeight - (level / 100 * maxHeight),
                                gridValue: Round(maxValue * level / 100, 0)
                            },
                            "<line x1='30' y1='" & gridY & "' x2='270' y2='" & gridY & "' stroke='#e5e7eb' stroke-width='1'/>" &
                            "<text x='25' y='" & (If(level = 100, gridY + 12, gridY + 4)) & "' text-anchor='end' font-size='10' fill='#999'>" & gridValue & "</text>"
                        )
                    ) &
                    Concat(
                        data,
                        With(
                            {
                                x: 30 + (idx - 1) * (240 / CountRows(data)),
                                barHeight: value / maxValue * maxHeight,
                                y: maxHeight - (value / maxValue * maxHeight)
                            },
                            "<rect x='" & x & "' y='" & y & "' width='" & (200 / CountRows(data)) & "' height='" & barHeight & "' fill='" & color & "' rx='4'/>" &
                            "<text x='" & (x + 100 / CountRows(data)) & "' y='195' text-anchor='middle' font-size='12' fill='#666'>" & label & "</text>"
                        )
                    ) &
                    "</svg>"
                )
            )
        )
    )
)`;

                case 2: // 円グラフ
                    return `With(
    {
        percentage: 75,
        color: "#667eea"
    },
    With(
        {
            circumference: 2 * Pi() * 80,
            useFullCircle: percentage >= 99.9
        },
        "data:image/svg+xml," & EncodeUrl(
            "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 200' width='200' height='200'>" &
            "<circle cx='100' cy='100' r='80' fill='#f0f0f0'/>" &
            If(
                useFullCircle,
                "<circle cx='100' cy='100' r='80' fill='none' stroke='" & color & "' stroke-width='160'/>",
                "<circle cx='100' cy='100' r='80' fill='none' stroke='" & color & "' stroke-width='160' stroke-dasharray='" & (circumference * percentage / 100) & " " & circumference & "' stroke-dashoffset='0' transform='rotate(-90 100 100)'/>"
            ) &
            "<text x='100' y='105' text-anchor='middle' font-size='32' font-weight='bold' fill='" & color & "'>" & percentage & "%</text>" &
            "</svg>"
        )
    )
)`;

                case 3: // 折れ線グラフ（ForAllで可変個数対応）
                    return `With(
    {
        data: Table(
            {idx: 1, value: 77}, {idx: 2, value: 62}, {idx: 3, value: 46}, {idx: 4, value: 54}, {idx: 5, value: 23}
        ),
        color: "#667eea",
        gridLines: Table({level: 0}, {level: 25}, {level: 50}, {level: 75}, {level: 100})
    },
    With(
        {
            dataMaxValue: Max(data, value),
            maxHeight: 130
        },
        With(
            {
                stepSize: If(dataMaxValue <= 10, 5, If(dataMaxValue <= 50, 10, If(dataMaxValue <= 100, 25, 50)))
            },
            With(
                {
                    maxValue: Round(dataMaxValue + stepSize, If(stepSize >= 50, -2, If(stepSize >= 10, -1, 0)))
                },
            "data:image/svg+xml," & EncodeUrl(
                "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 150' width='300' height='150'>" &
                "<defs><linearGradient id='lineGrad' x1='0%' y1='0%' x2='0%' y2='100%'><stop offset='0%' style='stop-color:" & color & ";stop-opacity:0.3' /><stop offset='100%' style='stop-color:" & color & ";stop-opacity:0' /></linearGradient></defs>" &
                Concat(
                    gridLines,
                    With(
                        {
                            gridY: maxHeight - (level / 100 * maxHeight),
                            gridValue: Round(maxValue * level / 100, 0)
                        },
                        "<line x1='20' y1='" & gridY & "' x2='280' y2='" & gridY & "' stroke='#e5e7eb' stroke-width='1'/>" &
                        "<text x='15' y='" & (If(level = 100, gridY + 12, gridY + 4)) & "' text-anchor='end' font-size='10' fill='#999'>" & gridValue & "</text>"
                    )
                ) &
                "<polyline points='" &
                Concat(
                    data,
                    With(
                        {
                            x: 20 + (idx - 1) * (260 / (CountRows(data) - 1)),
                            y: maxHeight - (value / maxValue * maxHeight)
                        },
                        x & "," & y
                    ),
                    " "
                ) &
                "' fill='none' stroke='" & color & "' stroke-width='3'/>" &
                "<polygon points='" &
                Concat(
                    data,
                    With(
                        {
                            x: 20 + (idx - 1) * (260 / (CountRows(data) - 1)),
                            y: maxHeight - (value / maxValue * maxHeight)
                        },
                        x & "," & y
                    ),
                    " "
                ) &
                " 280,130 20,130' fill='url(#lineGrad)'/>" &
                Concat(
                    data,
                    With(
                        {
                            x: 20 + (idx - 1) * (260 / (CountRows(data) - 1)),
                            y: maxHeight - (value / maxValue * maxHeight)
                        },
                        "<circle cx='" & x & "' cy='" & y & "' r='4' fill='" & color & "'/>"
                    )
                ) &
                "</svg>"
                )
            )
        )
    )
)`;

                case 4: // KPIカード
                    return `With(
    {
        title: "今月の売上",
        value: "¥1.2M",
        change: "+15%",
        changeLabel: "vs 先月"
    },
    "data:image/svg+xml," & EncodeUrl("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 150' width='300' height='150'><rect width='300' height='150' fill='#ffffff' rx='12'/><rect width='300' height='150' fill='url(#cardGrad)' rx='12' opacity='0.1'/><defs><linearGradient id='cardGrad' x1='0%' y1='0%' x2='100%' y2='100%'><stop offset='0%' style='stop-color:#667eea' /><stop offset='100%' style='stop-color:#764ba2' /></linearGradient></defs><text x='20' y='40' font-size='14' fill='#666' font-weight='500'>" & title & "</text><text x='20' y='85' font-size='36' fill='#1a1a1a' font-weight='bold'>" & value & "</text><text x='20' y='115' font-size='12' fill='#10b981'>↑ " & change & " " & changeLabel & "</text></svg>")
)`;

                case 7: // 積み上げ棒グラフ（ForAllで可変個数対応）
                    return `With(
    {
        data: Table(
            {bar: 1, segment: 1, value: 60, label: "Q1"},
            {bar: 1, segment: 2, value: 40, label: "Q1"},
            {bar: 2, segment: 1, value: 80, label: "Q2"},
            {bar: 2, segment: 2, value: 40, label: "Q2"},
            {bar: 3, segment: 1, value: 70, label: "Q3"},
            {bar: 3, segment: 2, value: 40, label: "Q3"}
        ),
        bars: Table(
            {barNum: 1, label: "Q1"},
            {barNum: 2, label: "Q2"},
            {barNum: 3, label: "Q3"}
        ),
        colors: Table(
            {segmentNum: 1, color: "#667eea"},
            {segmentNum: 2, color: "#764ba2"},
            {segmentNum: 3, color: "#f093fb"},
            {segmentNum: 4, color: "#4facfe"},
            {segmentNum: 5, color: "#00f2fe"}
        ),
        gridLines: Table({level: 0}, {level: 25}, {level: 50}, {level: 75}, {level: 100})
    },
    With(
        {
            maxHeight: 160,
            allBars: AddColumns(
                bars,
                totalValue,
                Sum(Filter(data, bar = barNum), value)
            ),
            dataMaxTotal: Max(
                AddColumns(
                    bars,
                    totalValue,
                    Sum(Filter(data, bar = barNum), value)
                ),
                totalValue
            )
        },
        With(
            {
                stepSize: If(dataMaxTotal <= 10, 5, If(dataMaxTotal <= 50, 10, If(dataMaxTotal <= 100, 25, 50)))
            },
            With(
                {
                    maxTotal: Round(dataMaxTotal + stepSize, If(stepSize >= 50, -2, If(stepSize >= 10, -1, 0)))
                },
                "data:image/svg+xml," & EncodeUrl(
                "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 200' width='300' height='200'>" &
                Concat(
                    gridLines,
                    With(
                        {
                            gridY: maxHeight - (level / 100 * maxHeight) + 20,
                            gridValue: Round(maxTotal * level / 100, 0)
                        },
                        "<line x1='30' y1='" & gridY & "' x2='280' y2='" & gridY & "' stroke='#e5e7eb' stroke-width='1'/>" &
                        "<text x='25' y='" & (If(level = 100, gridY + 12, gridY + 4)) & "' text-anchor='end' font-size='10' fill='#999'>" & gridValue & "</text>"
                    )
                ) &
                Concat(
                    bars,
                    With(
                        {barData: Filter(data, bar = barNum)},
                        With(
                            {
                                x: 30 + (barNum - 1) * (240 / CountRows(bars)),
                                barWidth: 200 / CountRows(bars),
                                maxSegment: Max(barData, segment)
                            },
                            Concat(
                                barData,
                                With(
                                    {
                                        currentSegment: segment,
                                        colorItem: LookUp(colors, segmentNum = segment),
                                        isTopSegment: segment = maxSegment
                                    },
                                    With(
                                        {
                                            segmentHeight: value / maxTotal * maxHeight,
                                            stackY: Sum(Filter(barData, segment <= currentSegment), value) / maxTotal * maxHeight,
                                            yPos: maxHeight - (Sum(Filter(barData, segment <= currentSegment), value) / maxTotal * maxHeight) + 20
                                        },
                                        If(
                                            isTopSegment,
                                            "<path d='M " & x & "," & (yPos + segmentHeight) &
                                            " L " & x & "," & (yPos + 4) &
                                            " Q " & x & "," & yPos & " " & (x + 4) & "," & yPos &
                                            " L " & (x + barWidth - 4) & "," & yPos &
                                            " Q " & (x + barWidth) & "," & yPos & " " & (x + barWidth) & "," & (yPos + 4) &
                                            " L " & (x + barWidth) & "," & (yPos + segmentHeight) &
                                            " Z' fill='" & colorItem.color & "'/>",
                                            "<rect x='" & x & "' y='" & yPos & "' width='" & barWidth & "' height='" & segmentHeight & "' fill='" & colorItem.color & "'/>"
                                        )
                                    )
                                )
                            ) &
                            "<text x='" & (x + barWidth / 2) & "' y='195' text-anchor='middle' font-size='11' fill='#666'>" & label & "</text>"
                        )
                    )
                ) &
                "</svg>"
                )
            )
        )
    )
)`;

                case 8: // 面グラフ（エリアチャート）
                    return `With(
    {
        data: Table(
            {idx: 1, value: 89}, {idx: 2, value: 74}, {idx: 3, value: 59}, {idx: 4, value: 67},
            {idx: 5, value: 44}, {idx: 6, value: 52}, {idx: 7, value: 37}
        ),
        color: "#10b981",
        gridLines: Table({level: 0}, {level: 25}, {level: 50}, {level: 75}, {level: 100})
    },
    With(
        {
            dataMaxValue: Max(data, value),
            maxHeight: 135
        },
        With(
            {
                stepSize: If(dataMaxValue <= 10, 5, If(dataMaxValue <= 50, 10, If(dataMaxValue <= 100, 25, 50)))
            },
            With(
                {
                    maxValue: Round(dataMaxValue + stepSize, If(stepSize >= 50, -2, If(stepSize >= 10, -1, 0)))
                },
            "data:image/svg+xml," & EncodeUrl(
                "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 150' width='300' height='150'>" &
                "<defs><linearGradient id='areaGrad' x1='0%' y1='0%' x2='0%' y2='100%'><stop offset='0%' style='stop-color:" & color & ";stop-opacity:0.5' /><stop offset='100%' style='stop-color:" & color & ";stop-opacity:0.05' /></linearGradient></defs>" &
                Concat(
                    gridLines,
                    With(
                        {
                            gridY: maxHeight - (level / 100 * maxHeight),
                            gridValue: Round(maxValue * level / 100, 0)
                        },
                        "<line x1='20' y1='" & gridY & "' x2='280' y2='" & gridY & "' stroke='#e5e7eb' stroke-width='1'/>" &
                        "<text x='15' y='" & (If(level = 100, gridY + 12, gridY + 4)) & "' text-anchor='end' font-size='10' fill='#999'>" & gridValue & "</text>"
                    )
                ) &
                "<polygon points='" &
                Concat(
                    data,
                    With(
                        {
                            x: 20 + (idx - 1) * (260 / (CountRows(data) - 1)),
                            y: maxHeight - (value / maxValue * maxHeight)
                        },
                        x & "," & y
                    ),
                    " "
                ) &
                " 280,135 20,135' fill='url(#areaGrad)'/>" &
                "<polyline points='" &
                Concat(
                    data,
                    With(
                        {
                            x: 20 + (idx - 1) * (260 / (CountRows(data) - 1)),
                            y: maxHeight - (value / maxValue * maxHeight)
                        },
                        x & "," & y
                    ),
                    " "
                ) &
                "' fill='none' stroke='" & color & "' stroke-width='2.5'/>" &
                Concat(
                    data,
                    With(
                        {
                            x: 20 + (idx - 1) * (260 / (CountRows(data) - 1)),
                            y: maxHeight - (value / maxValue * maxHeight)
                        },
                        "<circle cx='" & x & "' cy='" & y & "' r='3' fill='" & color & "'/>"
                    )
                ) &
                "</svg>"
                )
            )
        )
    )
)`;

                case 13: // ドーナツグラフ
                    return `With(
    {
        data: Table(
            {idx: 1, value: 45, color: "#667eea", label: "商品A"},
            {idx: 2, value: 30, color: "#764ba2", label: "商品B"},
            {idx: 3, value: 25, color: "#f093fb", label: "商品C"}
        ),
        centerLabel: "売上構成",
        radius: 70,
        strokeWidth: 30
    },
    With(
        {
            total: Sum(data, value),
            circumference: 2 * Pi() * radius
        },
        "data:image/svg+xml," & EncodeUrl(
            "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 200' width='200' height='200'>" &
            "<circle cx='100' cy='100' r='" & radius & "' fill='none' stroke='#f0f0f0' stroke-width='" & strokeWidth & "'/>" &
            Concat(
                data,
                With(
                    {
                        segmentPercentage: value / total * 100,
                        arcLength: circumference * value / total,
                        prevTotal: Sum(Filter(data, idx < ThisRecord.idx), value)
                    },
                    With(
                        {
                            offset: -(circumference * prevTotal / total),
                            isFullCircle: segmentPercentage >= 99.9
                        },
                        If(
                            isFullCircle,
                            "<circle cx='100' cy='100' r='" & radius & "' fill='none' stroke='" & color & "' stroke-width='" & strokeWidth & "'/>",
                            "<circle cx='100' cy='100' r='" & radius & "' fill='none' stroke='" & color & "' stroke-width='" & strokeWidth & "' stroke-dasharray='" & arcLength & " " & circumference & "' stroke-dashoffset='" & offset & "' transform='rotate(-90 100 100)'/>"
                        )
                    )
                )
            ) &
            "<text x='100' y='95' text-anchor='middle' dominant-baseline='middle' font-size='28' font-weight='bold' fill='#1a1a1a'>" & total & "</text>" &
            "<text x='100' y='115' text-anchor='middle' dominant-baseline='middle' font-size='12' fill='#666'>" & centerLabel & "</text>" &
            "</svg>"
        )
    )
)`;

                case 16: // 横棒グラフ（ForAllで可変個数対応）
                    return `With(
    {
        data: Table(
            {idx: 1, dept: "営業部", value: 90, color: "#667eea"},
            {idx: 2, dept: "開発部", value: 70, color: "#764ba2"},
            {idx: 3, dept: "総務部", value: 50, color: "#f093fb"}
        ),
        gridLines: Table({level: 0}, {level: 25}, {level: 50}, {level: 75}, {level: 100}),
        valueTextColor: "#fff",
        labelTextColor: "#666"
    },
    With(
        {
            dataMaxValue: Max(data, value),
            maxWidth: 200
        },
        With(
            {
                stepSize: If(dataMaxValue <= 10, 5, If(dataMaxValue <= 50, 10, If(dataMaxValue <= 100, 25, 50)))
            },
            With(
                {
                    maxValue: Round(dataMaxValue + stepSize, If(stepSize >= 50, -2, If(stepSize >= 10, -1, 0)))
                },
                "data:image/svg+xml," & EncodeUrl(
                    "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 150' width='300' height='150'>" &
                    Concat(
                        gridLines,
                        With(
                            {
                                gridX: 80 + (level / 100 * maxWidth),
                                gridValue: Round(maxValue * level / 100, 0)
                            },
                            "<line x1='" & gridX & "' y1='10' x2='" & gridX & "' y2='140' stroke='#e5e7eb' stroke-width='1'/>" &
                            If(level > 0, "<text x='" & gridX & "' y='8' text-anchor='middle' font-size='10' fill='#999'>" & gridValue & "</text>", "")
                        )
                    ) &
                    Concat(
                        data,
                        With(
                            {
                                y: 10 + (idx - 1) * (130 / CountRows(data)),
                                barWidth: value / maxValue * maxWidth
                            },
                            "<rect x='80' y='" & y & "' width='" & barWidth & "' height='" & (100 / CountRows(data)) & "' fill='" & color & "' rx='4'/>" &
                            "<text x='75' y='" & (y + 50 / CountRows(data) + 5) & "' text-anchor='end' font-size='12' fill='" & labelTextColor & "'>" & dept & "</text>" &
                            "<text x='" & (80 + barWidth - 5) & "' y='" & (y + 50 / CountRows(data) + 5) & "' font-size='12' fill='" & valueTextColor & "' font-weight='600'>" & value & "</text>"
                        )
                    ) &
                    "</svg>"
                )
            )
        )
    )
)`;

                case 17: // ミニKPIカード
                    return `With(
    {
        title: "売上高",
        value: "¥842K",
        change: "+12%",
        changeLabel: "前月比",
        trendType: "positive",
        positiveColor: "#10b981",
        negativeColor: "#ef4444",
        neutralColor: "#6b7280",
        iconBgColor: "#eff6ff",
        icon: "$"
    },
    With(
        {
            currentColor: If(trendType = "positive", positiveColor, If(trendType = "negative", negativeColor, neutralColor)),
            trendIcon: If(trendType = "positive", "↑", If(trendType = "negative", "↓", "−"))
        },
        "data:image/svg+xml," & EncodeUrl("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 100' width='180' height='100'><rect width='180' height='100' fill='#ffffff' rx='12' stroke='#e5e7eb' stroke-width='1'/><circle cx='30' cy='30' r='18' fill='" & iconBgColor & "'/><text x='30' y='37' text-anchor='middle' font-size='20' fill='#3b82f6'>" & icon & "</text><text x='65' y='30' font-size='11' fill='#666'>" & title & "</text><text x='20' y='70' font-size='28' fill='#1a1a1a' font-weight='bold'>" & value & "</text><text x='20' y='88' font-size='11' fill='" & currentColor & "'>" & trendIcon & " " & change & " " & changeLabel & "</text></svg>")
    )
)`;

                case 18: // 複数円グラフ比較（ForAllで可変個数対応）
                    return `With(
    {
        data: Table(
            {idx: 1, label: "2024年", percentage: 75, color: "#667eea"},
            {idx: 2, label: "2025年", percentage: 85, color: "#10b981"}
        )
    },
    "data:image/svg+xml," & EncodeUrl(
        "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 " & (140 * CountRows(data)) & " 140' width='" & (140 * CountRows(data)) & "' height='140'>" &
        Concat(
            data,
            With(
                {cx: 70 + (idx - 1) * 140},
                "<circle cx='" & cx & "' cy='70' r='50' fill='#f0f0f0'/>" &
                "<circle cx='" & cx & "' cy='70' r='50' fill='none' stroke='" & color & "' stroke-width='25' stroke-dasharray='" & (314 * percentage / 100) & " 314' stroke-dashoffset='0' transform='rotate(-90 " & cx & " 70)'/>" &
                "<text x='" & cx & "' y='75' text-anchor='middle' font-size='18' font-weight='bold' fill='#1a1a1a'>" & percentage & "%</text>" &
                "<text x='" & cx & "' y='135' text-anchor='middle' font-size='11' fill='#666'>" & label & "</text>"
            )
        ) &
        "</svg>"
    )
)`;

                case 21: // ダッシュボードヘッダー（ForAllで可変個数対応）
                    return `With(
    {
        kpis: Table(
            {idx: 1, label: "総売上", value: "¥2.4M"},
            {idx: 2, label: "新規顧客", value: "342"},
            {idx: 3, label: "契約率", value: "67%"},
            {idx: 4, label: "満足度", value: "4.8"}
        )
    },
    "data:image/svg+xml," & EncodeUrl(
        "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 400 80' width='400' height='80'>" &
        "<rect width='400' height='80' fill='#ffffff' rx='12' stroke='#e5e7eb' stroke-width='1'/>" &
        Concat(
            kpis,
            With(
                {
                    x: 20 + (idx - 1) * (380 / CountRows(kpis)),
                    divX: (idx - 1) * (400 / CountRows(kpis))
                },
                If(idx > 1, "<line x1='" & divX & "' y1='15' x2='" & divX & "' y2='65' stroke='#e5e7eb' stroke-width='1'/>", "") &
                "<text x='" & x & "' y='30' font-size='11' fill='#666'>" & label & "</text>" &
                "<text x='" & x & "' y='55' font-size='20' fill='#1a1a1a' font-weight='bold'>" & value & "</text>"
            )
        ) &
        "</svg>"
    )
)`;

                case 23: // 比較カード（ForAllで可変個数対応）
                    return `With(
    {
        title: "売上比較",
        data: Table(
            {idx: 1, year: "2024年", value: "¥1.8M", bgColor: "#f9fafb", textColor: "#666"},
            {idx: 2, year: "2025年", value: "¥2.1M", bgColor: "#eff6ff", textColor: "#3b82f6"}
        ),
        growth: "+16.7% 成長",
        boxWidth: 110,
        boxSpacing: 20
    },
    With(
        {totalWidth: CountRows(data) * 110 + (CountRows(data) + 1) * 20},
        "data:image/svg+xml," & EncodeUrl(
            "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 " & totalWidth & " 140' width='" & totalWidth & "' height='140'>" &
            "<rect width='" & totalWidth & "' height='140' fill='#ffffff' rx='12' stroke='#e5e7eb' stroke-width='1'/>" &
            "<text x='20' y='30' font-size='13' fill='#666' font-weight='500'>" & title & "</text>" &
            Concat(
                data,
                With(
                    {
                        xPos: 20 + (idx - 1) * (boxWidth + boxSpacing),
                        centerX: 20 + (idx - 1) * (boxWidth + boxSpacing) + boxWidth / 2
                    },
                    "<rect x='" & xPos & "' y='50' width='" & boxWidth & "' height='70' fill='" & bgColor & "' rx='8'/>" &
                    "<text x='" & centerX & "' y='70' text-anchor='middle' font-size='11' fill='#999'>" & year & "</text>" &
                    "<text x='" & centerX & "' y='95' text-anchor='middle' font-size='24' fill='" & textColor & "' font-weight='bold'>" & value & "</text>"
                )
            ) &
            "<rect x='" & (totalWidth / 2 - 45) & "' y='125' width='90' height='10' fill='#d1fae5' rx='5'/>" &
            "<text x='" & (totalWidth / 2) & "' y='133' text-anchor='middle' font-size='9' fill='#059669' font-weight='600'>" & growth & "</text>" &
            "</svg>"
        )
    )
)`;

                case 24: // タスク進捗カード
                    return `With(
    {
        title: "プロジェクト進捗",
        completed: 14,
        total: 20,
        inProgress: 6
    },
    "data:image/svg+xml," & EncodeUrl("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 120' width='300' height='120'><rect width='300' height='120' fill='#ffffff' rx='12' stroke='#e5e7eb' stroke-width='1'/><text x='20' y='25' font-size='13' fill='#666' font-weight='600'>" & title & "</text><text x='20' y='55' font-size='11' fill='#999'>完了タスク</text><rect x='20' y='62' width='260' height='12' fill='#f0f0f0' rx='6'/><rect x='20' y='62' width='" & (260 * completed / total) & "' height='12' fill='#10b981' rx='6'/><text x='280' y='72' text-anchor='end' font-size='11' fill='#1a1a1a' font-weight='600'>" & completed & "/" & total & "</text><circle cx='25' cy='95' r='4' fill='#10b981'/><text x='35' y='99' font-size='11' fill='#666'>完了: " & completed & "件</text><circle cx='125' cy='95' r='4' fill='#667eea'/><text x='135' y='99' font-size='11' fill='#666'>進行中: " & inProgress & "件</text></svg>")
)`;

                case 27: // ヒートマップ風カレンダー
                    return `With(
    {
        activityData: Table(
            {row: 1, col: 1, activity: 0}, {row: 1, col: 2, activity: 1}, {row: 1, col: 3, activity: 0}, {row: 1, col: 4, activity: 2},
            {row: 1, col: 5, activity: 0}, {row: 1, col: 6, activity: 3}, {row: 1, col: 7, activity: 1}, {row: 1, col: 8, activity: 0},
            {row: 1, col: 9, activity: 2}, {row: 1, col: 10, activity: 0}, {row: 1, col: 11, activity: 1}, {row: 1, col: 12, activity: 0},
            {row: 1, col: 13, activity: 2}, {row: 1, col: 14, activity: 3}, {row: 1, col: 15, activity: 0}, {row: 1, col: 16, activity: 1},
            {row: 1, col: 17, activity: 4}, {row: 1, col: 18, activity: 0},
            {row: 2, col: 1, activity: 1}, {row: 2, col: 2, activity: 2}, {row: 2, col: 3, activity: 0}, {row: 2, col: 4, activity: 0},
            {row: 2, col: 5, activity: 3}, {row: 2, col: 6, activity: 1}, {row: 2, col: 7, activity: 0}, {row: 2, col: 8, activity: 2},
            {row: 2, col: 9, activity: 0}, {row: 2, col: 10, activity: 1}, {row: 2, col: 11, activity: 0}, {row: 2, col: 12, activity: 3},
            {row: 2, col: 13, activity: 0}, {row: 2, col: 14, activity: 2}, {row: 2, col: 15, activity: 1}, {row: 2, col: 16, activity: 0},
            {row: 2, col: 17, activity: 0}, {row: 2, col: 18, activity: 3},
            {row: 3, col: 1, activity: 0}, {row: 3, col: 2, activity: 0}, {row: 3, col: 3, activity: 2}, {row: 3, col: 4, activity: 1},
            {row: 3, col: 5, activity: 0}, {row: 3, col: 6, activity: 0}, {row: 3, col: 7, activity: 2}, {row: 3, col: 8, activity: 1},
            {row: 3, col: 9, activity: 3}, {row: 3, col: 10, activity: 0}, {row: 3, col: 11, activity: 2}, {row: 3, col: 12, activity: 0},
            {row: 3, col: 13, activity: 1}, {row: 3, col: 14, activity: 0}, {row: 3, col: 15, activity: 0}, {row: 3, col: 16, activity: 4},
            {row: 3, col: 17, activity: 2}, {row: 3, col: 18, activity: 0},
            {row: 4, col: 1, activity: 2}, {row: 4, col: 2, activity: 1}, {row: 4, col: 3, activity: 0}, {row: 4, col: 4, activity: 0},
            {row: 4, col: 5, activity: 2}, {row: 4, col: 6, activity: 0}, {row: 4, col: 7, activity: 1}, {row: 4, col: 8, activity: 0},
            {row: 4, col: 9, activity: 0}, {row: 4, col: 10, activity: 2}, {row: 4, col: 11, activity: 1}, {row: 4, col: 12, activity: 0},
            {row: 4, col: 13, activity: 3}, {row: 4, col: 14, activity: 0}, {row: 4, col: 15, activity: 2}, {row: 4, col: 16, activity: 0},
            {row: 4, col: 17, activity: 1}, {row: 4, col: 18, activity: 2},
            {row: 5, col: 1, activity: 0}, {row: 5, col: 2, activity: 3}, {row: 5, col: 3, activity: 1}, {row: 5, col: 4, activity: 2},
            {row: 5, col: 5, activity: 0}, {row: 5, col: 6, activity: 2}, {row: 5, col: 7, activity: 0}, {row: 5, col: 8, activity: 3},
            {row: 5, col: 9, activity: 2}, {row: 5, col: 10, activity: 0}, {row: 5, col: 11, activity: 0}, {row: 5, col: 12, activity: 2},
            {row: 5, col: 14, activity: 1}, {row: 5, col: 15, activity: 0}, {row: 5, col: 16, activity: 2}, {row: 5, col: 17, activity: 0},
            {row: 5, col: 18, activity: 1},
            {row: 6, col: 1, activity: 1}, {row: 6, col: 2, activity: 0}, {row: 6, col: 3, activity: 0}, {row: 6, col: 4, activity: 3},
            {row: 6, col: 5, activity: 1}, {row: 6, col: 6, activity: 0}, {row: 6, col: 7, activity: 2}, {row: 6, col: 8, activity: 0},
            {row: 6, col: 9, activity: 1}, {row: 6, col: 10, activity: 0}, {row: 6, col: 11, activity: 3}, {row: 6, col: 12, activity: 1},
            {row: 6, col: 13, activity: 0}, {row: 6, col: 14, activity: 0}, {row: 6, col: 15, activity: 3}, {row: 6, col: 16, activity: 1},
            {row: 6, col: 17, activity: 0}, {row: 6, col: 18, activity: 0}
        ),
        colors: Table(
            {level: 0, color: "#ebedf0"},
            {level: 1, color: "#9be9a8"},
            {level: 2, color: "#40c463"},
            {level: 3, color: "#30a14e"},
            {level: 4, color: "#216e39"}
        ),
        cellSize: 8,
        cellGap: 4,
        startX: 10,
        startY: 10
    },
    "data:image/svg+xml," & EncodeUrl(
        "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 230 90' width='230' height='90'>" &
        Concat(
            activityData,
            With(
                {
                    x: startX + (col - 1) * (cellSize + cellGap),
                    y: startY + (row - 1) * (cellSize + cellGap),
                    fillColor: LookUp(colors, level = activity).color
                },
                "<rect x='" & x & "' y='" & y & "' width='" & cellSize & "' height='" & cellSize & "' fill='" & fillColor & "' rx='2'/>"
            )
        ) &
        "</svg>"
    )
)`;

                case 28: // 統計サマリーカード
                    return `With(
    {
        title: "総アクセス数",
        value: "12.5K",
        change: "+8.3%",
        changeCount: "962",
        changeLabel: "前日比",
        trendType: "positive",
        positiveColor: "#10b981",
        negativeColor: "#ef4444",
        neutralColor: "#6b7280",
        positiveBgColor: "#f0fdf4",
        negativeBgColor: "#fef2f2",
        neutralBgColor: "#f3f4f6"
    },
    With(
        {
            currentColor: If(trendType = "positive", positiveColor, If(trendType = "negative", negativeColor, neutralColor)),
            currentBgColor: If(trendType = "positive", positiveBgColor, If(trendType = "negative", negativeBgColor, neutralBgColor)),
            trendIcon: If(trendType = "positive", "↑", If(trendType = "negative", "↓", "−"))
        },
        "data:image/svg+xml," & EncodeUrl("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 220 110' width='220' height='110'><rect width='220' height='110' fill='#ffffff' rx='12' stroke='#e5e7eb' stroke-width='1'/><rect x='15' y='15' width='40' height='40' fill='" & currentBgColor & "' rx='8'/><text x='35' y='42' text-anchor='middle' font-size='24' fill='" & currentColor & "'>" & trendIcon & "</text><text x='65' y='28' font-size='12' fill='#999'>" & title & "</text><text x='65' y='55' font-size='26' fill='#1a1a1a' font-weight='bold'>" & value & "</text><rect x='15' y='70' width='190' height='25' fill='#f9fafb' rx='6'/><text x='22' y='86' font-size='11' fill='#666'>" & changeLabel & "</text><text x='198' y='86' text-anchor='end' font-size='11' fill='" & currentColor & "' font-weight='600'>" & change & " (" & changeCount & ")</text></svg>")
    )
)`;

                case 25: // レーダーチャート
                    return `With(
    {
        data: Table(
            {idx: 1, category: "品質", value: 80},
            {idx: 2, category: "価格", value: 60},
            {idx: 3, category: "デザイン", value: 90},
            {idx: 4, category: "サポート", value: 70},
            {idx: 5, category: "速度", value: 85}
        ),
        centerX: 100,
        centerY: 100,
        maxRadius: 70
    },
    With(
        {
            dataMaxValue: Max(data, value)
        },
        With(
            {
                stepSize: If(dataMaxValue <= 10, 5, If(dataMaxValue <= 50, 10, If(dataMaxValue <= 100, 25, 50)))
            },
            With(
                {
                    maxValue: Round(dataMaxValue + stepSize, If(stepSize >= 50, -2, If(stepSize >= 10, -1, 0)))
                },
                With(
                    {
                        scaleRings: Table(
                            {level: 0, label: "0"},
                            {level: 50, label: Text(Round(maxValue * 0.5, 0))},
                            {level: 100, label: Text(maxValue)}
                        )
                    },
                "data:image/svg+xml," & EncodeUrl(
                    "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 200' width='200' height='200'>" &
                    Concat(
                        scaleRings,
                        With(
                            {ringRadius: level / 100 * maxRadius},
                            "<polygon points='" &
                            Concat(
                                data,
                                With(
                                    {ringAngle: (idx - 1) * (360 / CountRows(data)) - 90},
                                    (centerX + ringRadius * Cos(ringAngle * Pi() / 180)) & "," & (centerY + ringRadius * Sin(ringAngle * Pi() / 180))
                                ),
                                " "
                            ) &
                            "' fill='none' stroke='#e5e7eb' stroke-width='1'/>"
                        )
                    ) &
                    Concat(
                        data,
                        With(
                            {axisAngle: (idx - 1) * (360 / CountRows(data)) - 90},
                            "<line x1='" & centerX & "' y1='" & centerY &
                            "' x2='" & (centerX + maxRadius * Cos(axisAngle * Pi() / 180)) &
                            "' y2='" & (centerY + maxRadius * Sin(axisAngle * Pi() / 180)) &
                            "' stroke='#e5e7eb' stroke-width='1'/>"
                        )
                    ) &
                    "<polygon points='" &
                    Concat(
                        data,
                        With(
                            {
                                dataAngle: (idx - 1) * (360 / CountRows(data)) - 90,
                                dataRadius: value / maxValue * maxRadius
                            },
                            (centerX + dataRadius * Cos(dataAngle * Pi() / 180)) & "," & (centerY + dataRadius * Sin(dataAngle * Pi() / 180))
                        ),
                        " "
                    ) &
                    "' fill='#667eea' fill-opacity='0.3' stroke='#667eea' stroke-width='2'/>" &
                    Concat(
                        data,
                        With(
                            {
                                pointAngle: (idx - 1) * (360 / CountRows(data)) - 90,
                                pointRadius: value / maxValue * maxRadius,
                                labelRadius: maxRadius + 15
                            },
                            "<circle cx='" & (centerX + pointRadius * Cos(pointAngle * Pi() / 180)) &
                            "' cy='" & (centerY + pointRadius * Sin(pointAngle * Pi() / 180)) &
                            "' r='4' fill='#667eea'/>" &
                            "<text x='" & (centerX + labelRadius * Cos(pointAngle * Pi() / 180)) &
                            "' y='" & (centerY + labelRadius * Sin(pointAngle * Pi() / 180) + 4) &
                            "' text-anchor='middle' font-size='10' fill='#666'>" & category & "</text>" &
                            "<text x='" & (centerX + labelRadius * Cos(pointAngle * Pi() / 180)) &
                            "' y='" & (centerY + labelRadius * Sin(pointAngle * Pi() / 180) + 16) &
                            "' text-anchor='middle' font-size='9' fill='#667eea' font-weight='600'>" & value & "</text>"
                        )
                    ) &
                    "</svg>"
                )
                )
            )
        )
    )
)`;

                case 31: // 集合縦棒グラフ
                    return `With(
    {
        data: Table(
            {period: "Q1", series: 1, value: 70, label: "商品A"},
            {period: "Q1", series: 2, value: 55, label: "商品B"},
            {period: "Q2", series: 1, value: 75, label: "商品A"},
            {period: "Q2", series: 2, value: 60, label: "商品B"},
            {period: "Q3", series: 1, value: 65, label: "商品A"},
            {period: "Q3", series: 2, value: 50, label: "商品B"}
        ),
        periods: Table({num: 1, name: "Q1"}, {num: 2, name: "Q2"}, {num: 3, name: "Q3"}),
        colors: Table({seriesNum: 1, color: "#667eea"}, {seriesNum: 2, color: "#764ba2"}),
        gridLines: Table({level: 0}, {level: 25}, {level: 50}, {level: 75}, {level: 100})
    },
    With(
        {
            dataMaxValue: Max(data, value),
            maxHeight: 160,
            seriesCount: Max(data, series),
            periodCount: CountRows(periods),
            availableWidth: 250,
            minGroupGap: 15,
            barGapRatio: 0.2
        },
        With(
            {
                stepSize: If(dataMaxValue <= 10, 5, If(dataMaxValue <= 50, 10, If(dataMaxValue <= 100, 25, 50))),
                totalGroupGaps: (periodCount - 1) * minGroupGap
            },
            With(
                {
                    maxValue: Round(dataMaxValue + stepSize, If(stepSize >= 50, -2, If(stepSize >= 10, -1, 0))),
                    widthPerGroup: (availableWidth - totalGroupGaps) / periodCount
                },
                With(
                    {
                        barGap: Round(widthPerGroup / (seriesCount * 5), 1)
                    },
                    With(
                        {
                            totalBarGaps: (seriesCount - 1) * barGap,
                            barWidth: (widthPerGroup - (seriesCount - 1) * barGap) / seriesCount,
                            groupWidth: widthPerGroup - barGap
                        },
                        With(
                            {
                                periodSpacing: widthPerGroup + minGroupGap
                            },
                "data:image/svg+xml," & EncodeUrl(
                    "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 200' width='300' height='200'>" &
                    Concat(
                        gridLines,
                        With(
                            {
                                gridY: 180 - (level / 100 * maxHeight),
                                gridValue: Round(maxValue * level / 100, 0)
                            },
                            "<line x1='30' y1='" & gridY & "' x2='280' y2='" & gridY & "' stroke='#e5e7eb' stroke-width='1'/>" &
                            "<text x='25' y='" & (If(level = 100, gridY + 12, gridY + 4)) & "' text-anchor='end' font-size='10' fill='#999'>" & gridValue & "</text>"
                        )
                    ) &
                    Concat(
                        data,
                        With(
                            {
                                periodData: LookUp(periods, name = period),
                                colorData: LookUp(colors, seriesNum = series)
                            },
                            With(
                                {
                                    barHeight: value / maxValue * maxHeight,
                                    x: 30 + (periodData.num - 1) * periodSpacing + (series - 1) * (barWidth + barGap)
                                },
                                "<rect x='" & x & "' y='" & (maxHeight - barHeight + 20) & "' width='" & barWidth & "' height='" & barHeight & "' fill='" & colorData.color & "' rx='3'/>"
                            )
                        )
                    ) &
                    Concat(
                        periods,
                        "<text x='" & (30 + (num - 1) * periodSpacing + widthPerGroup / 2) & "' y='195' text-anchor='middle' font-size='11' fill='#666'>" & name & "</text>"
                    ) &
                    "</svg>"
                )
                        )
                    )
                )
            )
        )
    )
)`;

                case 32: // 100%積み上げ縦棒グラフ
                    return `With(
    {
        data: Table(
            {period: 1, segment: 1, value: 40, label: "1月"},
            {period: 1, segment: 2, value: 30, label: "1月"},
            {period: 1, segment: 3, value: 30, label: "1月"},
            {period: 2, segment: 1, value: 45, label: "2月"},
            {period: 2, segment: 2, value: 35, label: "2月"},
            {period: 2, segment: 3, value: 20, label: "2月"},
            {period: 3, segment: 1, value: 50, label: "3月"},
            {period: 3, segment: 2, value: 25, label: "3月"},
            {period: 3, segment: 3, value: 25, label: "3月"}
        ),
        periods: Table({num: 1, name: "1月"}, {num: 2, name: "2月"}, {num: 3, name: "3月"}),
        colors: Table(
            {segmentNum: 1, color: "#667eea"},
            {segmentNum: 2, color: "#764ba2"},
            {segmentNum: 3, color: "#f093fb"}
        ),
        chartHeight: 160,
        gridLines: Table({level: 0}, {level: 25}, {level: 50}, {level: 75}, {level: 100})
    },
    With(
        {
            periodCount: CountRows(periods),
            availableWidth: 250,
            leftMargin: 30
        },
        With(
            {
                periodWidth: availableWidth / periodCount,
                barWidth: availableWidth / periodCount * 0.65
            },
            "data:image/svg+xml," & EncodeUrl(
                "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 200' width='300' height='200'>" &
                Concat(
                    gridLines,
                    With(
                        {gridY: 20 + ((100 - level) / 100 * chartHeight)},
                        "<line x1='30' y1='" & gridY & "' x2='280' y2='" & gridY & "' stroke='#e5e7eb' stroke-width='1'/>" &
                        "<text x='25' y='" & (If(level = 0, gridY + 12, gridY + 4)) & "' text-anchor='end' font-size='10' fill='#999'>" & level & "%</text>"
                    )
                ) &
                Concat(
                    periods,
                    With(
                        {periodData: Filter(data, period = num)},
                        With(
                            {
                                totalValue: Sum(periodData, value),
                                x: leftMargin + (num - 1) * periodWidth + (periodWidth - barWidth) / 2
                            },
                            Concat(
                                periodData,
                                With(
                                    {currentSegment: segment},
                                    With(
                                        {
                                            colorData: LookUp(colors, segmentNum = currentSegment),
                                            segmentHeight: value / totalValue * chartHeight,
                                            yOffset: Sum(Filter(periodData, segment < currentSegment), value) / totalValue * chartHeight,
                                            isTop: currentSegment = 1,
                                            radius: 4
                                        },
                                        With(
                                            {
                                                y: 20 + yOffset
                                            },
                                            If(
                                                isTop,
                                                "<path d='M " & x & " " & (y + segmentHeight) &
                                                " V " & (y + radius) &
                                                " Q " & x & " " & y & " " & (x + radius) & " " & y &
                                                " H " & (x + barWidth - radius) &
                                                " Q " & (x + barWidth) & " " & y & " " & (x + barWidth) & " " & (y + radius) &
                                                " V " & (y + segmentHeight) &
                                                " H " & x &
                                                " Z' fill='" & colorData.color & "'/>",
                                                "<rect x='" & x & "' y='" & y & "' width='" & barWidth & "' height='" & segmentHeight & "' fill='" & colorData.color & "'/>"
                                            )
                                        )
                                    )
                                )
                            ) &
                            "<text x='" & (x + barWidth / 2) & "' y='195' text-anchor='middle' font-size='11' fill='#666'>" & name & "</text>"
                        )
                    )
                ) &
                "</svg>"
            )
        )
    )
)`;

                case 33: // 散布図
                    return `With(
    {
        data: Table(
            {x: 30, y: 70, series: 1},
            {x: 60, y: 60, series: 1},
            {x: 90, y: 50, series: 1},
            {x: 120, y: 43, series: 1},
            {x: 150, y: 35, series: 1},
            {x: 180, y: 25, series: 1},
            {x: 210, y: 18, series: 1},
            {x: 45, y: 78, series: 2},
            {x: 80, y: 65, series: 2},
            {x: 110, y: 55, series: 2},
            {x: 140, y: 48, series: 2},
            {x: 170, y: 38, series: 2},
            {x: 200, y: 30, series: 2},
            {x: 230, y: 23, series: 2}
        ),
        colors: Table({series: 1, color: "#667eea"}, {series: 2, color: "#764ba2"}),
        chartWidth: 250,
        chartHeight: 160,
        gridLines: Table({level: 0}, {level: 25}, {level: 50}, {level: 75}, {level: 100})
    },
    With(
        {
            maxX: Max(data, x),
            dataMaxY: Max(data, y)
        },
        With(
            {
                stepSize: If(dataMaxY <= 10, 5, If(dataMaxY <= 50, 10, If(dataMaxY <= 100, 25, 50)))
            },
            With(
                {
                    maxY: Round(dataMaxY + stepSize, If(stepSize >= 50, -2, If(stepSize >= 10, -1, 0)))
                },
                "data:image/svg+xml," & EncodeUrl(
                "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 200' width='300' height='200'>" &
                "<line x1='30' y1='180' x2='280' y2='180' stroke='#e5e7eb' stroke-width='2'/>" &
                "<line x1='30' y1='180' x2='30' y2='20' stroke='#e5e7eb' stroke-width='2'/>" &
                Concat(
                    gridLines,
                    With(
                        {
                            gridY: 180 - (level / 100 * chartHeight),
                            gridValue: Round(maxY * level / 100, 0)
                        },
                        "<line x1='30' y1='" & gridY & "' x2='280' y2='" & gridY & "' stroke='#f0f0f0' stroke-width='1'/>" &
                        "<text x='25' y='" & (If(level = 100, gridY + 12, gridY + 4)) & "' text-anchor='end' font-size='10' fill='#999'>" & gridValue & "</text>"
                    )
                ) &
                Concat(
                    data,
                    With(
                        {
                            currentSeries: series
                        },
                        With(
                            {
                                colorData: LookUp(colors, series = currentSeries),
                                plotX: 30 + (x / maxX) * chartWidth,
                                plotY: 180 - (y / maxY) * chartHeight
                            },
                            "<circle cx='" & plotX & "' cy='" & plotY & "' r='5' fill='" & colorData.color & "'/>"
                        )
                    )
                ) &
                "</svg>"
                )
            )
        )
    )
)`;

                case 34: // バブルチャート
                    return `With(
    {
        data: Table(
            {x: 40, y: 70, radius: 15, series: 1},
            {x: 90, y: 55, radius: 25, series: 2},
            {x: 140, y: 40, radius: 20, series: 3},
            {x: 190, y: 25, radius: 30, series: 4},
            {x: 70, y: 63, radius: 12, series: 1},
            {x: 120, y: 48, radius: 18, series: 2},
            {x: 170, y: 33, radius: 22, series: 3}
        ),
        colors: Table(
            {series: 1, color: "#667eea"},
            {series: 2, color: "#764ba2"},
            {series: 3, color: "#f093fb"},
            {series: 4, color: "#4facfe"}
        ),
        gridLines: Table({level: 0}, {level: 25}, {level: 50}, {level: 75}, {level: 100})
    },
    With(
        {
            maxX: Max(data, x),
            dataMaxY: Max(data, y),
            dataMinY: Min(data, y),
            maxRadius: Max(data, radius),
            leftMargin: 50,
            rightMargin: 40,
            topMargin: 40,
            bottomMargin: 30
        },
        With(
            {
                dataRangeY: dataMaxY - dataMinY,
                chartWidth: 300 - leftMargin - rightMargin,
                chartHeight: 200 - topMargin - bottomMargin,
                axisBottom: 200 - bottomMargin,
                safeMaxRadius: Min(topMargin - 8, bottomMargin - 8, leftMargin / 3, rightMargin / 3)
            },
            With(
                {
                    stepSize: If(dataRangeY <= 10, 5, If(dataRangeY <= 50, 10, If(dataRangeY <= 100, 25, 50))),
                    bubbleScaleFactor: Min(1, safeMaxRadius / maxRadius)
                },
                With(
                    {
                        minY: If(dataMinY < stepSize, 0, Round(dataMinY - stepSize, -1)),
                        maxY: Round(dataMaxY + stepSize, If(stepSize >= 50, -2, If(stepSize >= 10, -1, 0)))
                    },
                    With(
                        {
                            rangeY: maxY - minY
                        },
                "data:image/svg+xml," & EncodeUrl(
                    "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 200' width='300' height='200'>" &
                    "<line x1='" & leftMargin & "' y1='" & axisBottom & "' x2='" & (300 - rightMargin) & "' y2='" & axisBottom & "' stroke='#e5e7eb' stroke-width='2'/>" &
                    "<line x1='" & leftMargin & "' y1='" & axisBottom & "' x2='" & leftMargin & "' y2='" & topMargin & "' stroke='#e5e7eb' stroke-width='2'/>" &
                    Concat(
                        gridLines,
                        With(
                            {
                                gridY: axisBottom - (level / 100 * chartHeight),
                                gridValue: Round(minY + (rangeY * level / 100), 0)
                            },
                            "<line x1='" & leftMargin & "' y1='" & gridY & "' x2='" & (300 - rightMargin) & "' y2='" & gridY & "' stroke='#f0f0f0' stroke-width='1'/>" &
                            "<text x='" & (leftMargin - 5) & "' y='" & (If(level = 100, gridY + 12, gridY + 4)) & "' text-anchor='end' font-size='10' fill='#999'>" & gridValue & "</text>"
                        )
                    ) &
                    Concat(
                        data,
                        With(
                            {
                                currentSeries: series
                            },
                            With(
                                {
                                    colorData: LookUp(colors, series = currentSeries),
                                    plotX: leftMargin + (x / maxX) * chartWidth,
                                    plotY: axisBottom - ((y - minY) / rangeY) * chartHeight,
                                    scaledRadius: radius * bubbleScaleFactor
                                },
                                "<circle cx='" & plotX & "' cy='" & plotY & "' r='" & scaledRadius & "' fill='" & colorData.color & "' fill-opacity='0.6' stroke='" & colorData.color & "' stroke-width='2'/>"
                            )
                        )
                    ) &
                    "</svg>"
                        )
                    )
                )
            )
        )
    )
)`;

                case 35: // 縦棒折れ線複合グラフ
                    return `With(
    {
        barData: Table(
            {idx: 1, value: 50, label: "1月"},
            {idx: 2, value: 60, label: "2月"},
            {idx: 3, value: 45, label: "3月"},
            {idx: 4, value: 65, label: "4月"},
            {idx: 5, value: 55, label: "5月"}
        ),
        lineData: Table(
            {idx: 1, value: 50},
            {idx: 2, value: 35},
            {idx: 3, value: 43},
            {idx: 4, value: 30},
            {idx: 5, value: 38}
        ),
        barColor: "#667eea",
        lineColor: "#f093fb",
        gridLines: Table({level: 0}, {level: 25}, {level: 50}, {level: 75}, {level: 100})
    },
    With(
        {
            dataMaxValue: Max(Max(barData, value), Max(lineData, value)),
            maxHeight: 160,
            barCount: CountRows(barData),
            availableWidth: 250,
            leftMargin: 30
        },
        With(
            {
                stepSize: If(dataMaxValue <= 10, 5, If(dataMaxValue <= 50, 10, If(dataMaxValue <= 100, 25, 50))),
                itemSpacing: availableWidth / barCount,
                barWidth: availableWidth / barCount * 0.7
            },
            With(
                {
                    maxValue: Round(dataMaxValue + stepSize, If(stepSize >= 50, -2, If(stepSize >= 10, -1, 0)))
                },
                "data:image/svg+xml," & EncodeUrl(
                "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 200' width='300' height='200'>" &
                Concat(
                    gridLines,
                    With(
                        {
                            gridY: 180 - (level / 100 * maxHeight),
                            gridValue: Round(maxValue * level / 100, 0)
                        },
                        "<line x1='30' y1='" & gridY & "' x2='280' y2='" & gridY & "' stroke='#e5e7eb' stroke-width='1'/>" &
                        "<text x='25' y='" & (If(level = 100, gridY + 12, gridY + 4)) & "' text-anchor='end' font-size='10' fill='#999'>" & gridValue & "</text>"
                    )
                ) &
                Concat(
                    barData,
                    With(
                        {
                            barHeight: value / maxValue * maxHeight,
                            x: leftMargin + (idx - 1) * itemSpacing + (itemSpacing - barWidth) / 2
                        },
                        "<rect x='" & x & "' y='" & (180 - barHeight) & "' width='" & barWidth & "' height='" & barHeight & "' fill='" & barColor & "' rx='4'/>"
                    )
                ) &
                "<polyline points='" &
                Concat(
                    lineData,
                    With(
                        {
                            x: leftMargin + (idx - 1) * itemSpacing + itemSpacing / 2,
                            y: 180 - (value / maxValue * maxHeight)
                        },
                        x & "," & y
                    ),
                    " "
                ) &
                "' fill='none' stroke='" & lineColor & "' stroke-width='3'/>" &
                Concat(
                    lineData,
                    With(
                        {
                            x: leftMargin + (idx - 1) * itemSpacing + itemSpacing / 2,
                            y: 180 - (value / maxValue * maxHeight)
                        },
                        "<circle cx='" & x & "' cy='" & y & "' r='5' fill='" & lineColor & "' stroke='#fff' stroke-width='2'/>"
                    )
                ) &
                Concat(
                    barData,
                    With(
                        {x: leftMargin + (idx - 1) * itemSpacing + itemSpacing / 2},
                        "<text x='" & x & "' y='195' text-anchor='middle' font-size='11' fill='#666'>" & label & "</text>"
                    )
                ) &
                "</svg>"
                )
            )
        )
    )
)`;

                case 10: // スパークライン
                    return `With(
    {
        data: Table(
            {idx: 1, value: 30},
            {idx: 2, value: 25},
            {idx: 3, value: 28},
            {idx: 4, value: 18},
            {idx: 5, value: 22},
            {idx: 6, value: 15},
            {idx: 7, value: 20},
            {idx: 8, value: 12}
        ),
        lineColor: "#667eea",
        dotColor: "#667eea",
        width: 120,
        height: 40
    },
    With(
        {
            dataMax: Max(data, value),
            dataMin: Min(data, value),
            pointCount: CountRows(data)
        },
        With(
            {
                range: dataMax - dataMin,
                xStep: (width - 10) / (pointCount - 1)
            },
            "data:image/svg+xml," & EncodeUrl(
                "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 " & width & " " & height & "' width='" & width & "' height='" & height & "'>" &
                "<polyline points='" &
                Concat(
                    data,
                    With(
                        {
                            x: 5 + (idx - 1) * xStep,
                            y: height - 5 - ((value - dataMin) / range * (height - 10))
                        },
                        x & "," & y
                    ),
                    " "
                ) &
                "' fill='none' stroke='" & lineColor & "' stroke-width='2'/>" &
                With(
                    {
                        lastPoint: Last(data)
                    },
                    With(
                        {
                            lastX: 5 + (lastPoint.idx - 1) * xStep,
                            lastY: height - 5 - ((lastPoint.value - dataMin) / range * (height - 10))
                        },
                        "<circle cx='" & lastX & "' cy='" & lastY & "' r='3' fill='" & dotColor & "'/>"
                    )
                ) &
                "</svg>"
            )
        )
    )
)`;

                // 数値を扱わないサンプルはシンプルなコードを返す
                default:
                    return `"data:image/svg+xml," & EncodeUrl("${cleanSvg(svgCode)}")`;
            }
        }

        // モーダルを閉じる
        function closeModal() {
            document.getElementById('modal').classList.remove('show');
            document.body.style.overflow = 'auto';
        }

        // SVGコードをコピー
        function copySvgCode() {
            const code = document.getElementById('modalCode').textContent;
            navigator.clipboard.writeText(code).then(() => {
                showCopyNotification('SVGコードをコピーしました');
            });
        }

        // Power Apps用コードをコピー
        function copyPowerAppsCode() {
            const code = document.getElementById('modalPowerAppsCode').textContent;
            navigator.clipboard.writeText(code).then(() => {
                showCopyNotification('Power Apps用コードをコピーしました');
            });
        }

        // コピー通知
        function showCopyNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'fixed bottom-8 right-8 bg-gray-900 text-white px-6 py-3 rounded-lg shadow-lg z-50 flex items-center gap-2';
            notification.innerHTML = `
                <span class="material-symbols-rounded text-[20px]">check_circle</span>
                ${message}
            `;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
    </script>
</body>
</html>
