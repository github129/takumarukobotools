<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Power Apps SVG Gallery | たく丸工房</title>
    <meta name="description" content="Power Appsで使えるSVGグラフやカードのサンプル集。コピペですぐに使える実用的なSVGコードを提供。カスタマイズも自由自在。">
    <meta property="og:title" content="Power Apps SVG Gallery | たく丸工房">
    <meta property="og:description" content="Power Appsで使えるSVGグラフ・カードのサンプル集">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://tools.takumarukobo.com/power-apps-svg-gallery/">

    <link rel="icon" type="image/png" href="../logo.png">
    <link rel="apple-touch-icon" href="../logo.png">

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Noto+Sans+JP:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,0,0" />

    <style>
        body {
            font-family: 'Inter', 'Noto Sans JP', sans-serif;
            background-color: #F5F5F7;
            color: #1D1D1F;
        }
        html { scroll-behavior: smooth; }

        .material-symbols-rounded {
            font-variation-settings: 'FILL' 0, 'wght' 400, 'GRAD' 0, 'opsz' 24;
        }

        .svg-card {
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        .svg-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 24px -8px rgba(0,0,0,0.15);
        }

        .category-tag {
            transition: all 0.2s ease;
        }

        .category-tag.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.show {
            display: flex;
        }

        .code-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 1rem;
            border-radius: 8px;
            overflow-x: auto;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 13px;
            line-height: 1.6;
        }
    </style>
</head>
<body class="antialiased">

    <!-- ナビゲーションバー -->
    <nav class="fixed top-0 w-full z-50 bg-white/70 backdrop-blur-xl border-b border-gray-200/50 transition-all duration-300">
        <div class="max-w-7xl mx-auto px-6 h-14 flex items-center justify-between">
            <div class="flex items-center gap-2">
                <div class="w-8 h-8 rounded-lg overflow-hidden shadow-sm">
                    <img src="../logo.png" alt="たく丸工房 Logo" class="w-full h-full object-cover">
                </div>
                <span class="font-semibold tracking-tight text-gray-900">たく丸工房 Tools</span>
            </div>
            <div class="hidden md:flex space-x-6 text-sm font-medium text-gray-500">
                <a href="../index.html" class="hover:text-gray-900 transition-colors">Tools</a>
                <a href="../about.html" class="hover:text-gray-900 transition-colors">About</a>
                <a href="https://takumarukobo.com/" target="_blank" class="hover:text-gray-900 transition-colors">Home</a>
            </div>
        </div>
    </nav>

    <!-- ヘッダー -->
    <section class="pt-32 pb-12 px-6 text-center max-w-5xl mx-auto">
        <span class="inline-flex items-center gap-1 py-1 px-3 rounded-full bg-white border border-gray-200 text-xs font-semibold text-indigo-600 mb-6 shadow-sm">
            <span class="material-symbols-rounded text-[16px]">palette</span> SVG Gallery
        </span>
        <h1 class="text-4xl md:text-5xl font-bold tracking-tight leading-tight mb-6 text-gray-900">
            Power Apps用<br class="md:hidden"><span class="text-transparent bg-clip-text bg-gradient-to-r from-indigo-600 to-purple-600">SVGサンプル集</span>
        </h1>
        <p class="text-lg text-gray-500 font-normal leading-relaxed max-w-2xl mx-auto mb-8">
            ダッシュボード構築に必要なグラフ、KPIカード、インジケーターが30種類以上。<br>
            コピペですぐに使える、実用的なビジュアル要素が揃っています。
        </p>

        <!-- 検索バー -->
        <div class="max-w-xl mx-auto mb-8">
            <div class="relative">
                <span class="material-symbols-rounded absolute left-4 top-1/2 -translate-y-1/2 text-gray-400">search</span>
                <input
                    type="text"
                    id="searchInput"
                    placeholder="サンプルを検索..."
                    class="w-full pl-12 pr-4 py-3 rounded-2xl border border-gray-200 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent transition-all bg-white shadow-sm"
                >
            </div>
        </div>

        <!-- カテゴリータグ -->
        <div class="flex flex-wrap gap-2 justify-center mb-6">
            <button class="category-tag active px-4 py-2 rounded-full text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200" data-category="all">
                すべて
            </button>
            <button class="category-tag px-4 py-2 rounded-full text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200" data-category="graph">
                グラフ
            </button>
            <button class="category-tag px-4 py-2 rounded-full text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200" data-category="card">
                KPIカード
            </button>
            <button class="category-tag px-4 py-2 rounded-full text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200" data-category="dashboard">
                ダッシュボード
            </button>
            <button class="category-tag px-4 py-2 rounded-full text-sm font-medium bg-gray-100 text-gray-700 hover:bg-gray-200" data-category="indicator">
                インジケーター
            </button>
        </div>

        <!-- 件数表示 -->
        <p class="text-sm text-gray-500">
            <span id="resultCount">0</span> 件のサンプル
        </p>
    </section>

    <!-- SVGギャラリー -->
    <section class="px-6 pb-32 max-w-7xl mx-auto">
        <div id="galleryGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <!-- SVGカードがここに動的に生成されます -->
        </div>

        <!-- 検索結果なし -->
        <div id="noResults" class="hidden text-center py-20">
            <span class="material-symbols-rounded text-6xl text-gray-300 mb-4">search_off</span>
            <p class="text-gray-500 text-lg">該当するサンプルが見つかりませんでした</p>
        </div>
    </section>

    <!-- モーダル -->
    <div id="modal" class="modal">
        <div class="bg-white rounded-3xl max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto shadow-2xl">
            <div class="sticky top-0 bg-white border-b border-gray-200 px-8 py-6 flex items-center justify-between rounded-t-3xl">
                <div>
                    <h2 id="modalTitle" class="text-2xl font-bold text-gray-900 mb-1">サンプル名</h2>
                    <p id="modalCategory" class="text-sm text-gray-500">カテゴリー</p>
                </div>
                <button onclick="closeModal()" class="text-gray-400 hover:text-gray-600 transition-colors">
                    <span class="material-symbols-rounded text-[32px]">close</span>
                </button>
            </div>

            <div class="p-8">
                <!-- プレビュー -->
                <div class="mb-8">
                    <h3 class="text-sm font-semibold text-gray-700 mb-4 uppercase tracking-wide">プレビュー</h3>
                    <div class="bg-gradient-to-br from-gray-50 to-gray-100 rounded-2xl p-12 flex items-center justify-center min-h-[300px]">
                        <div id="modalPreview" class="w-full max-w-md"></div>
                    </div>
                </div>

                <!-- 説明 -->
                <div class="mb-8">
                    <h3 class="text-sm font-semibold text-gray-700 mb-3 uppercase tracking-wide">説明</h3>
                    <p id="modalDescription" class="text-gray-600 leading-relaxed"></p>
                </div>

                <!-- SVGコード -->
                <div class="mb-8">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="text-sm font-semibold text-gray-700 uppercase tracking-wide">SVGコード</h3>
                        <button onclick="copySvgCode()" class="px-4 py-2 bg-indigo-600 hover:bg-indigo-700 text-white text-sm font-medium rounded-lg transition-colors flex items-center gap-2">
                            <span class="material-symbols-rounded text-[18px]">content_copy</span>
                            コピー
                        </button>
                    </div>
                    <div class="code-block">
                        <pre id="modalCode"></pre>
                    </div>
                </div>

                <!-- Power Apps用コード -->
                <div>
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="text-sm font-semibold text-gray-700 uppercase tracking-wide">Power Apps用コード</h3>
                        <button onclick="copyPowerAppsCode()" class="px-4 py-2 bg-purple-600 hover:bg-purple-700 text-white text-sm font-medium rounded-lg transition-colors flex items-center gap-2">
                            <span class="material-symbols-rounded text-[18px]">content_copy</span>
                            コピー
                        </button>
                    </div>
                    <div class="code-block">
                        <pre id="modalPowerAppsCode"></pre>
                    </div>
                    <p class="text-sm text-gray-500 mt-3">
                        <span class="material-symbols-rounded text-[16px] align-middle">info</span>
                        ImageコントロールのImageプロパティに貼り付けてください
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- フッター -->
    <footer class="border-t border-gray-200 bg-white py-12 px-6">
        <div class="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center gap-6">
            <div class="flex items-center gap-2">
                <div class="w-6 h-6 rounded overflow-hidden">
                    <img src="../logo.png" alt="たく丸工房 Logo" class="w-full h-full object-cover">
                </div>
                <p class="text-gray-500 text-sm">© 2025 Takumaru Kobo. All rights reserved.</p>
            </div>
            <div class="flex space-x-6">
                <a href="../about.html" class="text-gray-400 hover:text-gray-900 text-sm transition-colors">About</a>
                <a href="https://takumarukobo.com/page-152/" class="text-gray-400 hover:text-gray-900 text-sm transition-colors">お問い合わせ</a>
                <a href="https://x.com/taku_ma_ru" class="text-gray-400 hover:text-gray-900 text-sm transition-colors">X (Twitter)</a>
            </div>
        </div>
    </footer>

    <script>
        // SVGサンプルデータ
        const svgSamples = [
            {
                id: 1,
                title: "シンプル棒グラフ",
                category: "graph",
                description: "3つのデータを棒グラフで表示。色やサイズをカスタマイズ可能。月次比較や部門別データの表示に最適。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 200" width="300" height="200">
  <rect x="50" y="80" width="40" height="100" fill="#667eea" rx="4"/>
  <rect x="130" y="40" width="40" height="140" fill="#764ba2" rx="4"/>
  <rect x="210" y="100" width="40" height="80" fill="#f093fb" rx="4"/>
  <text x="70" y="195" text-anchor="middle" font-size="12" fill="#666">1月</text>
  <text x="150" y="195" text-anchor="middle" font-size="12" fill="#666">2月</text>
  <text x="230" y="195" text-anchor="middle" font-size="12" fill="#666">3月</text>
</svg>`
            },
            {
                id: 2,
                title: "円グラフ",
                category: "graph",
                description: "2色の円グラフ。パーセンテージ表示付き。中央のテキストもカスタマイズ可能。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200" width="200" height="200">
  <circle cx="100" cy="100" r="80" fill="#f0f0f0"/>
  <circle cx="100" cy="100" r="80" fill="none" stroke="#667eea" stroke-width="40" stroke-dasharray="377 377" stroke-dashoffset="94.25" transform="rotate(-90 100 100)"/>
  <text x="100" y="105" text-anchor="middle" font-size="32" font-weight="bold" fill="#667eea">75%</text>
</svg>`
            },
            {
                id: 3,
                title: "折れ線グラフ",
                category: "graph",
                description: "トレンドを示す折れ線グラフ。グラデーション背景付きで視認性抜群。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 150" width="300" height="150">
  <defs>
    <linearGradient id="lineGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#667eea;stop-opacity:0.3" />
      <stop offset="100%" style="stop-color:#667eea;stop-opacity:0" />
    </linearGradient>
  </defs>
  <polyline points="20,100 80,80 140,60 200,70 260,30" fill="none" stroke="#667eea" stroke-width="3"/>
  <polygon points="20,100 80,80 140,60 200,70 260,30 260,130 20,130" fill="url(#lineGrad)"/>
  <circle cx="20" cy="100" r="4" fill="#667eea"/>
  <circle cx="80" cy="80" r="4" fill="#667eea"/>
  <circle cx="140" cy="60" r="4" fill="#667eea"/>
  <circle cx="200" cy="70" r="4" fill="#667eea"/>
  <circle cx="260" cy="30" r="4" fill="#667eea"/>
</svg>`
            },
            {
                id: 4,
                title: "KPIカード",
                category: "card",
                description: "売上や目標達成率などのKPIを表示するカード。数値とラベルを簡単に変更可能。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 150" width="300" height="150">
  <rect width="300" height="150" fill="#ffffff" rx="12"/>
  <rect width="300" height="150" fill="url(#cardGrad)" rx="12" opacity="0.1"/>
  <defs>
    <linearGradient id="cardGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#667eea" />
      <stop offset="100%" style="stop-color:#764ba2" />
    </linearGradient>
  </defs>
  <text x="20" y="40" font-size="14" fill="#666" font-weight="500">今月の売上</text>
  <text x="20" y="85" font-size="36" fill="#1a1a1a" font-weight="bold">¥1.2M</text>
  <text x="20" y="115" font-size="12" fill="#10b981">↑ 15% vs 先月</text>
</svg>`
            },
            {
                id: 5,
                title: "ステータスカード",
                category: "card",
                description: "プロジェクトやタスクのステータスを表示。アイコンと色でステータスを視覚化。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 120" width="300" height="120">
  <rect width="300" height="120" fill="#ffffff" rx="12" stroke="#e5e7eb" stroke-width="1"/>
  <circle cx="40" cy="60" r="20" fill="#10b981" opacity="0.1"/>
  <path d="M 35 60 L 38 63 L 45 56" stroke="#10b981" stroke-width="2" fill="none" stroke-linecap="round"/>
  <text x="75" y="55" font-size="16" fill="#1a1a1a" font-weight="600">プロジェクト完了</text>
  <text x="75" y="75" font-size="12" fill="#666">すべてのタスクが完了しました</text>
</svg>`
            },
            {
                id: 6,
                title: "情報カード",
                category: "card",
                description: "アイコン付きの情報カード。通知やお知らせの表示に最適。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 100" width="300" height="100">
  <rect width="300" height="100" fill="#eff6ff" rx="12"/>
  <rect x="0" y="0" width="6" height="100" fill="#3b82f6" rx="12"/>
  <circle cx="35" cy="50" r="12" fill="#3b82f6" opacity="0.2"/>
  <text x="35" y="55" font-size="16" fill="#3b82f6" font-weight="bold" text-anchor="middle">i</text>
  <text x="60" y="45" font-size="14" fill="#1a1a1a" font-weight="600">重要なお知らせ</text>
  <text x="60" y="65" font-size="12" fill="#666">システムメンテナンスを実施します</text>
</svg>`
            },
            {
                id: 7,
                title: "積み上げ棒グラフ",
                category: "graph",
                description: "複数のデータ系列を積み上げて表示。売上構成比や費用内訳の可視化に最適。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 200" width="300" height="200">
  <rect x="50" y="100" width="40" height="60" fill="#667eea" rx="4"/>
  <rect x="50" y="60" width="40" height="40" fill="#764ba2" rx="4"/>
  <rect x="130" y="80" width="40" height="80" fill="#667eea" rx="4"/>
  <rect x="130" y="40" width="40" height="40" fill="#764ba2" rx="4"/>
  <rect x="210" y="90" width="40" height="70" fill="#667eea" rx="4"/>
  <rect x="210" y="50" width="40" height="40" fill="#764ba2" rx="4"/>
  <text x="70" y="185" text-anchor="middle" font-size="11" fill="#666">Q1</text>
  <text x="150" y="185" text-anchor="middle" font-size="11" fill="#666">Q2</text>
  <text x="230" y="185" text-anchor="middle" font-size="11" fill="#666">Q3</text>
</svg>`
            },
            {
                id: 8,
                title: "面グラフ（エリアチャート）",
                category: "graph",
                description: "時系列データの推移を面で表現。売上トレンドやアクセス数の変化を視覚化。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 150" width="300" height="150">
  <defs>
    <linearGradient id="areaGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#10b981;stop-opacity:0.5" />
      <stop offset="100%" style="stop-color:#10b981;stop-opacity:0.05" />
    </linearGradient>
  </defs>
  <polygon points="20,120 50,100 100,80 150,90 200,60 250,70 280,50 280,135 20,135" fill="url(#areaGrad)"/>
  <polyline points="20,120 50,100 100,80 150,90 200,60 250,70 280,50" fill="none" stroke="#10b981" stroke-width="2.5"/>
  <circle cx="20" cy="120" r="3" fill="#10b981"/>
  <circle cx="50" cy="100" r="3" fill="#10b981"/>
  <circle cx="100" cy="80" r="3" fill="#10b981"/>
  <circle cx="150" cy="90" r="3" fill="#10b981"/>
  <circle cx="200" cy="60" r="3" fill="#10b981"/>
  <circle cx="250" cy="70" r="3" fill="#10b981"/>
  <circle cx="280" cy="50" r="3" fill="#10b981"/>
</svg>`
            },
            {
                id: 9,
                title: "半円ゲージ",
                category: "indicator",
                description: "達成率や満足度を半円ゲージで表示。スピードメーター風のデザイン。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 120" width="200" height="120">
  <defs>
    <linearGradient id="gaugeGrad" x1="0%" y1="0%" x2="100%" y2="0%">
      <stop offset="0%" style="stop-color:#ef4444" />
      <stop offset="50%" style="stop-color:#fbbf24" />
      <stop offset="100%" style="stop-color:#10b981" />
    </linearGradient>
  </defs>
  <path d="M 30 100 A 70 70 0 0 1 170 100" fill="none" stroke="#e5e7eb" stroke-width="20" stroke-linecap="round"/>
  <path d="M 30 100 A 70 70 0 0 1 140 40" fill="none" stroke="url(#gaugeGrad)" stroke-width="20" stroke-linecap="round"/>
  <circle cx="100" cy="100" r="8" fill="#667eea"/>
  <line x1="100" y1="100" x2="140" y2="45" stroke="#667eea" stroke-width="3" stroke-linecap="round"/>
  <text x="100" y="95" text-anchor="middle" font-size="24" font-weight="bold" fill="#1a1a1a">78%</text>
</svg>`
            },
            {
                id: 10,
                title: "スパークライン",
                category: "indicator",
                description: "コンパクトなトレンド表示。KPIカード内に埋め込んで使用できます。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 40" width="120" height="40">
  <polyline points="5,30 20,25 35,28 50,18 65,22 80,15 95,20 110,12" fill="none" stroke="#667eea" stroke-width="2"/>
  <circle cx="110" cy="12" r="3" fill="#667eea"/>
</svg>`
            },
            {
                id: 11,
                title: "トレンドインジケーター（上昇）",
                category: "indicator",
                description: "数値の増減を矢印で表示。売上やユーザー数の変化を一目で確認。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 60" width="100" height="60">
  <rect width="100" height="60" fill="#d1fae5" rx="8"/>
  <polygon points="50,15 65,35 55,35 55,45 45,45 45,35 35,35" fill="#10b981"/>
  <text x="50" y="58" text-anchor="middle" font-size="10" fill="#059669" font-weight="600">+15.3%</text>
</svg>`
            },
            {
                id: 12,
                title: "トレンドインジケーター（下降）",
                category: "indicator",
                description: "マイナス成長を示すインジケーター。コスト削減や在庫減少の表示に。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 60" width="100" height="60">
  <rect width="100" height="60" fill="#fee2e2" rx="8"/>
  <polygon points="50,45 35,25 45,25 45,15 55,15 55,25 65,25" fill="#ef4444"/>
  <text x="50" y="58" text-anchor="middle" font-size="10" fill="#dc2626" font-weight="600">-8.7%</text>
</svg>`
            },
            {
                id: 13,
                title: "ドーナツグラフ",
                category: "graph",
                description: "中央に数値を表示できるドーナツ型のグラフ。複数の値を同時に表示可能。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200" width="200" height="200">
  <circle cx="100" cy="100" r="70" fill="none" stroke="#f0f0f0" stroke-width="30"/>
  <circle cx="100" cy="100" r="70" fill="none" stroke="#667eea" stroke-width="30" stroke-dasharray="264 440" stroke-dashoffset="0" transform="rotate(-90 100 100)"/>
  <circle cx="100" cy="100" r="70" fill="none" stroke="#764ba2" stroke-width="30" stroke-dasharray="132 440" stroke-dashoffset="-264" transform="rotate(-90 100 100)"/>
  <text x="100" y="95" text-anchor="middle" font-size="28" font-weight="bold" fill="#1a1a1a">85%</text>
  <text x="100" y="115" text-anchor="middle" font-size="12" fill="#666">達成率</text>
</svg>`
            },
            {
                id: 14,
                title: "円形プログレスリング",
                category: "indicator",
                description: "完了率を円形で表示。プロジェクト進捗やタスク達成率の可視化に。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 120 120" width="120" height="120">
  <circle cx="60" cy="60" r="50" fill="none" stroke="#f0f0f0" stroke-width="12"/>
  <circle cx="60" cy="60" r="50" fill="none" stroke="#667eea" stroke-width="12" stroke-dasharray="220 314" stroke-dashoffset="0" transform="rotate(-90 60 60)" stroke-linecap="round"/>
  <text x="60" y="65" text-anchor="middle" font-size="24" font-weight="bold" fill="#1a1a1a">70%</text>
</svg>`
            },
            {
                id: 15,
                title: "メトリクスカード",
                category: "dashboard",
                description: "複数の指標を一度に表示。ダッシュボードのメインコンポーネントとして最適。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 180" width="300" height="180">
  <rect width="300" height="180" fill="#ffffff" rx="12" stroke="#e5e7eb" stroke-width="1"/>
  <text x="20" y="30" font-size="14" fill="#666" font-weight="500">パフォーマンス</text>
  <line x1="20" y1="45" x2="280" y2="45" stroke="#e5e7eb" stroke-width="1"/>
  <text x="20" y="75" font-size="12" fill="#666">アクティブユーザー</text>
  <text x="280" y="75" font-size="18" fill="#667eea" font-weight="bold" text-anchor="end">1,234</text>
  <text x="20" y="110" font-size="12" fill="#666">新規登録</text>
  <text x="280" y="110" font-size="18" fill="#10b981" font-weight="bold" text-anchor="end">+89</text>
  <text x="20" y="145" font-size="12" fill="#666">コンバージョン率</text>
  <text x="280" y="145" font-size="18" fill="#764ba2" font-weight="bold" text-anchor="end">3.2%</text>
</svg>`
            },
            {
                id: 16,
                title: "横棒グラフ",
                category: "graph",
                description: "横向きの棒グラフ。ランキングや比較データの表示に適しています。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 150" width="300" height="150">
  <rect x="80" y="20" width="180" height="20" fill="#667eea" rx="4"/>
  <rect x="80" y="60" width="140" height="20" fill="#764ba2" rx="4"/>
  <rect x="80" y="100" width="100" height="20" fill="#f093fb" rx="4"/>
  <text x="75" y="35" text-anchor="end" font-size="12" fill="#666">営業部</text>
  <text x="75" y="75" text-anchor="end" font-size="12" fill="#666">開発部</text>
  <text x="75" y="115" text-anchor="end" font-size="12" fill="#666">総務部</text>
  <text x="265" y="35" font-size="12" fill="#fff" font-weight="600">90%</text>
  <text x="225" y="75" font-size="12" fill="#fff" font-weight="600">70%</text>
  <text x="185" y="115" font-size="12" fill="#fff" font-weight="600">50%</text>
</svg>`
            },
            {
                id: 17,
                title: "ミニKPIカード",
                category: "card",
                description: "コンパクトなKPI表示。複数並べてダッシュボードを構成できます。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 180 100" width="180" height="100">
  <rect width="180" height="100" fill="#ffffff" rx="12" stroke="#e5e7eb" stroke-width="1"/>
  <circle cx="30" cy="30" r="18" fill="#eff6ff"/>
  <text x="30" y="37" text-anchor="middle" font-size="20" fill="#3b82f6">$</text>
  <text x="65" y="30" font-size="11" fill="#666">売上高</text>
  <text x="20" y="70" font-size="28" fill="#1a1a1a" font-weight="bold">¥842K</text>
  <text x="20" y="88" font-size="11" fill="#10b981">↑ 12% 前月比</text>
</svg>`
            },
            {
                id: 18,
                title: "複数円グラフ比較",
                category: "graph",
                description: "2つの円グラフを並べて比較表示。前年比や目標との比較に。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 280 140" width="280" height="140">
  <circle cx="70" cy="70" r="50" fill="#f0f0f0"/>
  <circle cx="70" cy="70" r="50" fill="none" stroke="#667eea" stroke-width="25" stroke-dasharray="236 314" stroke-dashoffset="0" transform="rotate(-90 70 70)"/>
  <text x="70" y="75" text-anchor="middle" font-size="18" font-weight="bold" fill="#1a1a1a">75%</text>
  <text x="70" y="135" text-anchor="middle" font-size="11" fill="#666">2024年</text>
  <circle cx="210" cy="70" r="50" fill="#f0f0f0"/>
  <circle cx="210" cy="70" r="50" fill="none" stroke="#10b981" stroke-width="25" stroke-dasharray="267 314" stroke-dashoffset="0" transform="rotate(-90 210 70)"/>
  <text x="210" y="75" text-anchor="middle" font-size="18" font-weight="bold" fill="#1a1a1a">85%</text>
  <text x="210" y="135" text-anchor="middle" font-size="11" fill="#666">2025年</text>
</svg>`
            },
            {
                id: 19,
                title: "バッテリーインジケーター",
                category: "indicator",
                description: "残量や在庫レベルをバッテリー形式で表示。視覚的にわかりやすい。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 150 80" width="150" height="80">
  <rect x="20" y="25" width="100" height="30" fill="none" stroke="#e5e7eb" stroke-width="3" rx="4"/>
  <rect x="120" y="32" width="8" height="16" fill="#e5e7eb" rx="2"/>
  <rect x="24" y="29" width="68" height="22" fill="#10b981" rx="2"/>
  <text x="75" y="68" text-anchor="middle" font-size="14" fill="#666" font-weight="600">68%</text>
</svg>`
            },
            {
                id: 20,
                title: "温度計ゲージ",
                category: "indicator",
                description: "温度計風のゲージ。売上目標やリスクレベルの表示に。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 200" width="100" height="200">
  <rect x="40" y="20" width="20" height="130" fill="#f0f0f0" rx="10"/>
  <rect x="40" y="80" width="20" height="70" fill="#ef4444" rx="10"/>
  <circle cx="50" cy="165" r="20" fill="#ef4444"/>
  <text x="75" y="170" font-size="16" fill="#666" font-weight="600">HIGH</text>
  <line x1="65" y1="50" x2="72" y2="50" stroke="#999" stroke-width="2"/>
  <line x1="65" y1="90" x2="72" y2="90" stroke="#999" stroke-width="2"/>
  <line x1="65" y1="130" x2="72" y2="130" stroke="#999" stroke-width="2"/>
</svg>`
            },
            {
                id: 21,
                title: "ダッシュボードヘッダー",
                category: "dashboard",
                description: "4つのKPIを横並びで表示。ダッシュボードのトップに配置。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 80" width="400" height="80">
  <rect width="400" height="80" fill="#ffffff" rx="12" stroke="#e5e7eb" stroke-width="1"/>
  <text x="20" y="30" font-size="11" fill="#666">総売上</text>
  <text x="20" y="55" font-size="20" fill="#1a1a1a" font-weight="bold">¥2.4M</text>
  <line x1="100" y1="15" x2="100" y2="65" stroke="#e5e7eb" stroke-width="1"/>
  <text x="120" y="30" font-size="11" fill="#666">新規顧客</text>
  <text x="120" y="55" font-size="20" fill="#1a1a1a" font-weight="bold">342</text>
  <line x1="200" y1="15" x2="200" y2="65" stroke="#e5e7eb" stroke-width="1"/>
  <text x="220" y="30" font-size="11" fill="#666">契約率</text>
  <text x="220" y="55" font-size="20" fill="#1a1a1a" font-weight="bold">67%</text>
  <line x1="300" y1="15" x2="300" y2="65" stroke="#e5e7eb" stroke-width="1"/>
  <text x="320" y="30" font-size="11" fill="#666">満足度</text>
  <text x="320" y="55" font-size="20" fill="#1a1a1a" font-weight="bold">4.8</text>
</svg>`
            },
            {
                id: 22,
                title: "週間カレンダー",
                category: "dashboard",
                description: "1週間のスケジュール可視化。タスク管理やシフト表示に。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 280 100" width="280" height="100">
  <rect width="280" height="100" fill="#ffffff" rx="12" stroke="#e5e7eb" stroke-width="1"/>
  <text x="140" y="22" text-anchor="middle" font-size="12" fill="#666" font-weight="600">今週の予定</text>
  <rect x="15" y="35" width="35" height="50" fill="#eff6ff" rx="4"/>
  <text x="32.5" y="50" text-anchor="middle" font-size="10" fill="#3b82f6">月</text>
  <text x="32.5" y="70" text-anchor="middle" font-size="16" fill="#1a1a1a" font-weight="bold">5</text>
  <rect x="60" y="35" width="35" height="50" fill="#fff" rx="4" stroke="#e5e7eb"/>
  <text x="77.5" y="50" text-anchor="middle" font-size="10" fill="#666">火</text>
  <text x="77.5" y="70" text-anchor="middle" font-size="16" fill="#1a1a1a">6</text>
  <rect x="105" y="35" width="35" height="50" fill="#fff" rx="4" stroke="#e5e7eb"/>
  <text x="122.5" y="50" text-anchor="middle" font-size="10" fill="#666">水</text>
  <text x="122.5" y="70" text-anchor="middle" font-size="16" fill="#1a1a1a">7</text>
  <rect x="150" y="35" width="35" height="50" fill="#fff" rx="4" stroke="#e5e7eb"/>
  <text x="167.5" y="50" text-anchor="middle" font-size="10" fill="#666">木</text>
  <text x="167.5" y="70" text-anchor="middle" font-size="16" fill="#1a1a1a">8</text>
  <rect x="195" y="35" width="35" height="50" fill="#fff" rx="4" stroke="#e5e7eb"/>
  <text x="212.5" y="50" text-anchor="middle" font-size="10" fill="#666">金</text>
  <text x="212.5" y="70" text-anchor="middle" font-size="16" fill="#1a1a1a">9</text>
  <rect x="240" y="35" width="25" height="50" fill="#fef3c7" rx="4"/>
  <text x="252.5" y="50" text-anchor="middle" font-size="9" fill="#f59e0b">土</text>
  <text x="252.5" y="70" text-anchor="middle" font-size="14" fill="#1a1a1a">10</text>
</svg>`
            },
            {
                id: 23,
                title: "比較カード（vs 前年）",
                category: "card",
                description: "前年同期との比較を表示。成長率を視覚的に表現。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 280 140" width="280" height="140">
  <rect width="280" height="140" fill="#ffffff" rx="12" stroke="#e5e7eb" stroke-width="1"/>
  <text x="20" y="30" font-size="13" fill="#666" font-weight="500">売上比較</text>
  <rect x="20" y="50" width="110" height="70" fill="#f9fafb" rx="8"/>
  <text x="75" y="70" text-anchor="middle" font-size="11" fill="#999">2024年</text>
  <text x="75" y="95" text-anchor="middle" font-size="24" fill="#666" font-weight="bold">¥1.8M</text>
  <rect x="150" y="50" width="110" height="70" fill="#eff6ff" rx="8"/>
  <text x="205" y="70" text-anchor="middle" font-size="11" fill="#999">2025年</text>
  <text x="205" y="95" text-anchor="middle" font-size="24" fill="#3b82f6" font-weight="bold">¥2.1M</text>
  <rect x="95" y="125" width="90" height="10" fill="#d1fae5" rx="5"/>
  <text x="140" y="133" text-anchor="middle" font-size="9" fill="#059669" font-weight="600">+16.7% 成長</text>
</svg>`
            },
            {
                id: 24,
                title: "タスク進捗カード",
                category: "dashboard",
                description: "プロジェクトのタスク完了状況を表示。チーム管理に最適。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 300 120" width="300" height="120">
  <rect width="300" height="120" fill="#ffffff" rx="12" stroke="#e5e7eb" stroke-width="1"/>
  <text x="20" y="25" font-size="13" fill="#666" font-weight="600">プロジェクト進捗</text>
  <text x="20" y="55" font-size="11" fill="#999">完了タスク</text>
  <rect x="20" y="62" width="260" height="12" fill="#f0f0f0" rx="6"/>
  <rect x="20" y="62" width="182" height="12" fill="#10b981" rx="6"/>
  <text x="280" y="72" text-anchor="end" font-size="11" fill="#1a1a1a" font-weight="600">14/20</text>
  <circle cx="25" cy="95" r="4" fill="#10b981"/>
  <text x="35" y="99" font-size="11" fill="#666">完了: 14件</text>
  <circle cx="125" cy="95" r="4" fill="#667eea"/>
  <text x="135" y="99" font-size="11" fill="#666">進行中: 6件</text>
</svg>`
            },
            {
                id: 25,
                title: "レーダーチャート風",
                category: "graph",
                description: "5項目の評価を視覚化。スキル分析や製品評価に使用。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200" width="200" height="200">
  <polygon points="100,30 170,70 140,150 60,150 30,70" fill="none" stroke="#e5e7eb" stroke-width="1"/>
  <polygon points="100,50 145,80 120,135 80,135 55,80" fill="none" stroke="#d1d5db" stroke-width="1"/>
  <polygon points="100,80 110,95 105,110 95,110 90,95" fill="#667eea" fill-opacity="0.3" stroke="#667eea" stroke-width="2"/>
  <circle cx="100" cy="30" r="4" fill="#667eea"/>
  <circle cx="170" cy="70" r="4" fill="#667eea"/>
  <circle cx="140" cy="150" r="4" fill="#667eea"/>
  <circle cx="60" cy="150" r="4" fill="#667eea"/>
  <circle cx="30" cy="70" r="4" fill="#667eea"/>
  <text x="100" y="20" text-anchor="middle" font-size="10" fill="#666">品質</text>
  <text x="185" y="75" font-size="10" fill="#666">価格</text>
  <text x="150" y="170" font-size="10" fill="#666">デザイン</text>
  <text x="45" y="170" font-size="10" fill="#666">サポート</text>
  <text x="10" y="75" font-size="10" fill="#666">速度</text>
</svg>`
            },
            {
                id: 26,
                title: "ステップインジケーター",
                category: "indicator",
                description: "プロセスの進行状況を表示。申請フローやオンボーディングに。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 80" width="320" height="80">
  <line x1="40" y1="30" x2="280" y2="30" stroke="#e5e7eb" stroke-width="3"/>
  <circle cx="40" cy="30" r="14" fill="#10b981" stroke="#fff" stroke-width="3"/>
  <path d="M 35 30 L 38 33 L 45 26" stroke="white" stroke-width="2" fill="none" stroke-linecap="round"/>
  <text x="40" y="60" text-anchor="middle" font-size="11" fill="#10b981" font-weight="600">申請</text>
  <circle cx="120" cy="30" r="14" fill="#10b981" stroke="#fff" stroke-width="3"/>
  <path d="M 115 30 L 118 33 L 125 26" stroke="white" stroke-width="2" fill="none" stroke-linecap="round"/>
  <text x="120" y="60" text-anchor="middle" font-size="11" fill="#10b981" font-weight="600">確認</text>
  <circle cx="200" cy="30" r="14" fill="#667eea" stroke="#fff" stroke-width="3"/>
  <text x="200" y="35" text-anchor="middle" font-size="12" fill="#fff" font-weight="bold">3</text>
  <text x="200" y="60" text-anchor="middle" font-size="11" fill="#667eea" font-weight="600">承認</text>
  <circle cx="280" cy="30" r="14" fill="#e5e7eb" stroke="#fff" stroke-width="3"/>
  <text x="280" y="35" text-anchor="middle" font-size="12" fill="#999" font-weight="bold">4</text>
  <text x="280" y="60" text-anchor="middle" font-size="11" fill="#999">完了</text>
</svg>`
            },
            {
                id: 27,
                title: "ヒートマップ風カレンダー",
                category: "dashboard",
                description: "日々の活動量を色の濃さで表現。GitHub風の活動カレンダー。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 280 80" width="280" height="80">
  <text x="5" y="15" font-size="11" fill="#666">活動記録</text>
  <rect x="10" y="25" width="12" height="12" fill="#ebedf0" rx="2"/>
  <rect x="26" y="25" width="12" height="12" fill="#9be9a8" rx="2"/>
  <rect x="42" y="25" width="12" height="12" fill="#40c463" rx="2"/>
  <rect x="58" y="25" width="12" height="12" fill="#ebedf0" rx="2"/>
  <rect x="74" y="25" width="12" height="12" fill="#30a14e" rx="2"/>
  <rect x="90" y="25" width="12" height="12" fill="#9be9a8" rx="2"/>
  <rect x="106" y="25" width="12" height="12" fill="#ebedf0" rx="2"/>
  <rect x="10" y="41" width="12" height="12" fill="#40c463" rx="2"/>
  <rect x="26" y="41" width="12" height="12" fill="#ebedf0" rx="2"/>
  <rect x="42" y="41" width="12" height="12" fill="#9be9a8" rx="2"/>
  <rect x="58" y="41" width="12" height="12" fill="#40c463" rx="2"/>
  <rect x="74" y="41" width="12" height="12" fill="#9be9a8" rx="2"/>
  <rect x="90" y="41" width="12" height="12" fill="#ebedf0" rx="2"/>
  <rect x="106" y="41" width="12" height="12" fill="#30a14e" rx="2"/>
  <rect x="135" y="30" width="8" height="8" fill="#ebedf0" rx="2"/>
  <text x="148" y="37" font-size="9" fill="#999">少</text>
  <rect x="170" y="30" width="8" height="8" fill="#9be9a8" rx="2"/>
  <rect x="183" y="30" width="8" height="8" fill="#40c463" rx="2"/>
  <rect x="196" y="30" width="8" height="8" fill="#30a14e" rx="2"/>
  <rect x="209" y="30" width="8" height="8" fill="#216e39" rx="2"/>
  <text x="222" y="37" font-size="9" fill="#999">多</text>
</svg>`
            },
            {
                id: 28,
                title: "統計サマリーカード",
                category: "card",
                description: "総数と変化率を表示。ユーザー数やアクセス数の監視に。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 220 110" width="220" height="110">
  <rect width="220" height="110" fill="#ffffff" rx="12" stroke="#e5e7eb" stroke-width="1"/>
  <rect x="15" y="15" width="40" height="40" fill="#f0fdf4" rx="8"/>
  <text x="35" y="42" text-anchor="middle" font-size="24" fill="#10b981">↑</text>
  <text x="65" y="28" font-size="12" fill="#999">総アクセス数</text>
  <text x="65" y="55" font-size="26" fill="#1a1a1a" font-weight="bold">12.5K</text>
  <rect x="15" y="70" width="190" height="25" fill="#f9fafb" rx="6"/>
  <text x="22" y="86" font-size="11" fill="#666">前日比</text>
  <text x="198" y="86" text-anchor="end" font-size="11" fill="#10b981" font-weight="600">+8.3% (962)</text>
</svg>`
            },
            {
                id: 29,
                title: "目標達成メーター",
                category: "indicator",
                description: "目標に対する達成度を表示。営業目標や予算管理に。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 140" width="200" height="140">
  <text x="100" y="20" text-anchor="middle" font-size="13" fill="#666" font-weight="600">月次目標</text>
  <rect x="30" y="40" width="140" height="30" fill="#f0f0f0" rx="15"/>
  <rect x="30" y="40" width="112" height="30" fill="#10b981" rx="15"/>
  <text x="100" y="61" text-anchor="middle" font-size="14" fill="#fff" font-weight="bold">80%</text>
  <line x="142" y="35" x2="142" y2="75" stroke="#10b981" stroke-width="2" stroke-dasharray="4,3"/>
  <circle cx="142" cy="80" r="4" fill="#10b981"/>
  <text x="100" y="100" text-anchor="middle" font-size="12" fill="#999">達成額</text>
  <text x="100" y="120" text-anchor="middle" font-size="20" fill="#1a1a1a" font-weight="bold">¥800K</text>
  <text x="100" y="135" text-anchor="middle" font-size="10" fill="#999">/ ¥1,000K</text>
</svg>`
            },
            {
                id: 30,
                title: "リアルタイムカウンター",
                category: "dashboard",
                description: "数値を大きく表示。リアルタイム監視ダッシュボードに最適。",
                svgCode: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 250 120" width="250" height="120">
  <rect width="250" height="120" fill="#1a1a1a" rx="12"/>
  <text x="20" y="35" font-size="13" fill="#999" font-weight="500">オンラインユーザー</text>
  <text x="20" y="75" font-size="48" fill="#10b981" font-weight="bold" font-family="monospace">1,847</text>
  <circle cx="215" cy="30" r="8" fill="#10b981"/>
  <text x="230" y="35" font-size="11" fill="#10b981" font-weight="600">LIVE</text>
  <text x="20" y="100" font-size="11" fill="#666">最終更新: たった今</text>
</svg>`
            }
        ];

        let currentCategory = 'all';
        let currentSearchTerm = '';
        let currentSample = null;

        // ページ読み込み時に実行
        document.addEventListener('DOMContentLoaded', () => {
            renderGallery();
            setupEventListeners();
        });

        // イベントリスナーの設定
        function setupEventListeners() {
            // 検索
            document.getElementById('searchInput').addEventListener('input', (e) => {
                currentSearchTerm = e.target.value.toLowerCase();
                renderGallery();
            });

            // カテゴリータグ
            document.querySelectorAll('.category-tag').forEach(tag => {
                tag.addEventListener('click', (e) => {
                    document.querySelectorAll('.category-tag').forEach(t => t.classList.remove('active'));
                    e.target.classList.add('active');
                    currentCategory = e.target.dataset.category;
                    renderGallery();
                });
            });

            // モーダルの外側クリックで閉じる
            document.getElementById('modal').addEventListener('click', (e) => {
                if (e.target.id === 'modal') {
                    closeModal();
                }
            });
        }

        // ギャラリーの描画
        function renderGallery() {
            const grid = document.getElementById('galleryGrid');
            const noResults = document.getElementById('noResults');

            // フィルタリング
            let filteredSamples = svgSamples.filter(sample => {
                const matchesCategory = currentCategory === 'all' || sample.category === currentCategory;
                const matchesSearch = sample.title.toLowerCase().includes(currentSearchTerm) ||
                                     sample.description.toLowerCase().includes(currentSearchTerm);
                return matchesCategory && matchesSearch;
            });

            // 件数表示
            document.getElementById('resultCount').textContent = filteredSamples.length;

            // 結果なし表示
            if (filteredSamples.length === 0) {
                grid.innerHTML = '';
                noResults.classList.remove('hidden');
                return;
            }

            noResults.classList.add('hidden');

            // カード生成
            grid.innerHTML = filteredSamples.map(sample => `
                <div class="svg-card bg-white rounded-2xl p-6 border border-gray-200 shadow-sm cursor-pointer" onclick="openModal(${sample.id})">
                    <div class="bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-6 mb-4 flex items-center justify-center min-h-[200px]">
                        ${sample.svgCode}
                    </div>
                    <div class="mb-2">
                        <span class="inline-block px-3 py-1 bg-indigo-50 text-indigo-600 text-xs font-medium rounded-full mb-2">
                            ${getCategoryLabel(sample.category)}
                        </span>
                    </div>
                    <h3 class="text-lg font-bold text-gray-900 mb-2">${sample.title}</h3>
                    <p class="text-sm text-gray-500 leading-relaxed line-clamp-2">${sample.description}</p>
                    <div class="mt-4 flex items-center text-indigo-600 text-sm font-medium">
                        詳細を見る
                        <span class="material-symbols-rounded text-[18px] ml-1">arrow_forward</span>
                    </div>
                </div>
            `).join('');
        }

        // カテゴリーラベルの取得
        function getCategoryLabel(category) {
            const labels = {
                'graph': 'グラフ',
                'card': 'KPIカード',
                'dashboard': 'ダッシュボード',
                'indicator': 'インジケーター'
            };
            return labels[category] || category;
        }

        // モーダルを開く
        function openModal(id) {
            currentSample = svgSamples.find(s => s.id === id);
            if (!currentSample) return;

            document.getElementById('modalTitle').textContent = currentSample.title;
            document.getElementById('modalCategory').textContent = getCategoryLabel(currentSample.category);
            document.getElementById('modalDescription').textContent = currentSample.description;
            document.getElementById('modalPreview').innerHTML = currentSample.svgCode;
            document.getElementById('modalCode').textContent = currentSample.svgCode;

            // Power Apps用コード生成（With関数で変数化）
            let powerAppsCode = generatePowerAppsCode(id, currentSample.svgCode);
            document.getElementById('modalPowerAppsCode').textContent = powerAppsCode;

            document.getElementById('modal').classList.add('show');
            document.body.style.overflow = 'hidden';
        }

        // Power Apps用コード生成関数（With関数で変数化）
        function generatePowerAppsCode(id, svgCode) {
            const cleanSvg = (code) => code.replace(/\n/g, '').replace(/\s+/g, ' ').replace(/>\s+</g, '><').replace(/"/g, "'").trim();

            // サンプルIDに応じてWith関数付きコードを生成
            switch(id) {
                case 1: // シンプル棒グラフ（ForAllで可変個数対応）
                    return `With(
    {
        data: Table(
            {value: 100, color: "#667eea", label: "1月"},
            {value: 140, color: "#764ba2", label: "2月"},
            {value: 80, color: "#f093fb", label: "3月"}
        )
    },
    "data:image/svg+xml," & EncodeUrl(
        "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 200' width='300' height='200'>" &
        Concat(
            ForAll(
                Sequence(CountRows(data)),
                With(
                    {
                        item: Index(data, Value),
                        x: 30 + (Value - 1) * (240 / CountRows(data))
                    },
                    "<rect x='" & x & "' y='" & (180 - item.value) & "' width='" & (200 / CountRows(data)) & "' height='" & item.value & "' fill='" & item.color & "' rx='4'/>" &
                    "<text x='" & (x + 100 / CountRows(data)) & "' y='195' text-anchor='middle' font-size='12' fill='#666'>" & item.label & "</text>"
                )
            ),
            ""
        ) &
        "</svg>"
    )
)`;

                case 2: // 円グラフ
                    return `With(
    {
        percentage: 75,
        color: "#667eea"
    },
    "data:image/svg+xml," & EncodeUrl("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 200' width='200' height='200'><circle cx='100' cy='100' r='80' fill='#f0f0f0'/><circle cx='100' cy='100' r='80' fill='none' stroke='" & color & "' stroke-width='40' stroke-dasharray='377 377' stroke-dashoffset='" & (377 * (100 - percentage) / 100) & "' transform='rotate(-90 100 100)'/><text x='100' y='105' text-anchor='middle' font-size='32' font-weight='bold' fill='" & color & "'>" & percentage & "%</text></svg>")
)`;

                case 3: // 折れ線グラフ（ForAllで可変個数対応）
                    return `With(
    {
        data: Table(
            {y: 100}, {y: 80}, {y: 60}, {y: 70}, {y: 30}
        ),
        color: "#667eea"
    },
    "data:image/svg+xml," & EncodeUrl(
        "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 150' width='300' height='150'>" &
        "<defs><linearGradient id='lineGrad' x1='0%' y1='0%' x2='0%' y2='100%'><stop offset='0%' style='stop-color:" & color & ";stop-opacity:0.3' /><stop offset='100%' style='stop-color:" & color & ";stop-opacity:0' /></linearGradient></defs>" &
        "<polyline points='" &
        Concat(
            ForAll(
                Sequence(CountRows(data)),
                With({item: Index(data, Value), x: 20 + (Value - 1) * (260 / (CountRows(data) - 1))},
                    x & "," & item.y
                )
            ),
            " "
        ) &
        "' fill='none' stroke='" & color & "' stroke-width='3'/>" &
        "<polygon points='" &
        Concat(ForAll(Sequence(CountRows(data)), With({item: Index(data, Value), x: 20 + (Value - 1) * (260 / (CountRows(data) - 1))}, x & "," & item.y)), " ") &
        " 280,130 20,130' fill='url(#lineGrad)'/>" &
        Concat(
            ForAll(
                Sequence(CountRows(data)),
                With(
                    {item: Index(data, Value), x: 20 + (Value - 1) * (260 / (CountRows(data) - 1))},
                    "<circle cx='" & x & "' cy='" & item.y & "' r='4' fill='" & color & "'/>"
                )
            ),
            ""
        ) &
        "</svg>"
    )
)`;

                case 4: // KPIカード
                    return `With(
    {
        title: "今月の売上",
        value: "¥1.2M",
        change: "+15%",
        changeLabel: "vs 先月"
    },
    "data:image/svg+xml," & EncodeUrl("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 150' width='300' height='150'><rect width='300' height='150' fill='#ffffff' rx='12'/><rect width='300' height='150' fill='url(#cardGrad)' rx='12' opacity='0.1'/><defs><linearGradient id='cardGrad' x1='0%' y1='0%' x2='100%' y2='100%'><stop offset='0%' style='stop-color:#667eea' /><stop offset='100%' style='stop-color:#764ba2' /></linearGradient></defs><text x='20' y='40' font-size='14' fill='#666' font-weight='500'>" & title & "</text><text x='20' y='85' font-size='36' fill='#1a1a1a' font-weight='bold'>" & value & "</text><text x='20' y='115' font-size='12' fill='#10b981'>↑ " & change & " " & changeLabel & "</text></svg>")
)`;

                case 7: // 積み上げ棒グラフ（ForAllで可変個数対応）
                    return `With(
    {
        data: Table(
            {label: "Q1", values: [60, 40]},
            {label: "Q2", values: [80, 40]},
            {label: "Q3", values: [70, 40]}
        ),
        colors: ["#667eea", "#764ba2"]
    },
    "data:image/svg+xml," & EncodeUrl(
        "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 200' width='300' height='200'>" &
        Concat(
            ForAll(
                Sequence(CountRows(data)),
                With(
                    {
                        item: Index(data, Value),
                        x: 30 + (Value - 1) * (240 / CountRows(data)),
                        totalHeight: Sum(item.values)
                    },
                    Concat(
                        ForAll(
                            Sequence(CountRows(item.values)),
                            With(
                                {
                                    val: Index(item.values, Value),
                                    stackY: Sum(FirstN(item.values, Value)),
                                    color: Index(colors, Value)
                                },
                                "<rect x='" & x & "' y='" & (160 - stackY) & "' width='" & (200 / CountRows(data)) & "' height='" & val & "' fill='" & color & "' rx='4'/>"
                            )
                        ),
                        ""
                    ) &
                    "<text x='" & (x + 100 / CountRows(data)) & "' y='185' text-anchor='middle' font-size='11' fill='#666'>" & item.label & "</text>"
                )
            ),
            ""
        ) &
        "</svg>"
    )
)`;

                case 9: // 半円ゲージ
                    return `With(
    {
        percentage: 78
    },
    "data:image/svg+xml," & EncodeUrl("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 120' width='200' height='120'><defs><linearGradient id='gaugeGrad' x1='0%' y1='0%' x2='100%' y2='0%'><stop offset='0%' style='stop-color:#ef4444' /><stop offset='50%' style='stop-color:#fbbf24' /><stop offset='100%' style='stop-color:#10b981' /></linearGradient></defs><path d='M 30 100 A 70 70 0 0 1 170 100' fill='none' stroke='#e5e7eb' stroke-width='20' stroke-linecap='round'/><path d='M 30 100 A 70 70 0 " & If(percentage > 50, "1", "0") & " 1 " & (100 + 70 * Cos((percentage * 180 / 100) * Pi() / 180)) & " " & (100 - 70 * Sin((percentage * 180 / 100) * Pi() / 180)) & "' fill='none' stroke='url(#gaugeGrad)' stroke-width='20' stroke-linecap='round'/><text x='100' y='95' text-anchor='middle' font-size='24' font-weight='bold' fill='#1a1a1a'>" & percentage & "%</text></svg>")
)`;

                case 11: // トレンドインジケーター（上昇）
                    return `With(
    {
        percentage: 15.3
    },
    "data:image/svg+xml," & EncodeUrl("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 60' width='100' height='60'><rect width='100' height='60' fill='#d1fae5' rx='8'/><polygon points='50,15 65,35 55,35 55,45 45,45 45,35 35,35' fill='#10b981'/><text x='50' y='58' text-anchor='middle' font-size='10' fill='#059669' font-weight='600'>+" & percentage & "%</text></svg>")
)`;

                case 12: // トレンドインジケーター（下降）
                    return `With(
    {
        percentage: 8.7
    },
    "data:image/svg+xml," & EncodeUrl("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 60' width='100' height='60'><rect width='100' height='60' fill='#fee2e2' rx='8'/><polygon points='50,45 35,25 45,25 45,15 55,15 55,25 65,25' fill='#ef4444'/><text x='50' y='58' text-anchor='middle' font-size='10' fill='#dc2626' font-weight='600'>-" & percentage & "%</text></svg>")
)`;

                case 13: // ドーナツグラフ
                    return `With(
    {
        percentage: 85,
        color1: "#667eea",
        color2: "#764ba2",
        label: "達成率"
    },
    "data:image/svg+xml," & EncodeUrl("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 200' width='200' height='200'><circle cx='100' cy='100' r='70' fill='none' stroke='#f0f0f0' stroke-width='30'/><circle cx='100' cy='100' r='70' fill='none' stroke='" & color1 & "' stroke-width='30' stroke-dasharray='" & (440 * percentage * 0.6 / 100) & " 440' stroke-dashoffset='0' transform='rotate(-90 100 100)'/><circle cx='100' cy='100' r='70' fill='none' stroke='" & color2 & "' stroke-width='30' stroke-dasharray='" & (440 * (100 - percentage) * 0.6 / 100) & " 440' stroke-dashoffset='-" & (440 * percentage * 0.6 / 100) & "' transform='rotate(-90 100 100)'/><text x='100' y='95' text-anchor='middle' font-size='28' font-weight='bold' fill='#1a1a1a'>" & percentage & "%</text><text x='100' y='115' text-anchor='middle' font-size='12' fill='#666'>" & label & "</text></svg>")
)`;

                case 14: // 円形プログレスリング
                    return `With(
    {
        percentage: 70,
        color: "#667eea"
    },
    "data:image/svg+xml," & EncodeUrl("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 120 120' width='120' height='120'><circle cx='60' cy='60' r='50' fill='none' stroke='#f0f0f0' stroke-width='12'/><circle cx='60' cy='60' r='50' fill='none' stroke='" & color & "' stroke-width='12' stroke-dasharray='" & (314 * percentage / 100) & " 314' stroke-dashoffset='0' transform='rotate(-90 60 60)' stroke-linecap='round'/><text x='60' y='65' text-anchor='middle' font-size='24' font-weight='bold' fill='#1a1a1a'>" & percentage & "%</text></svg>")
)`;

                case 16: // 横棒グラフ（ForAllで可変個数対応）
                    return `With(
    {
        data: Table(
            {dept: "営業部", value: 90, color: "#667eea"},
            {dept: "開発部", value: 70, color: "#764ba2"},
            {dept: "総務部", value: 50, color: "#f093fb"}
        )
    },
    "data:image/svg+xml," & EncodeUrl(
        "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 150' width='300' height='150'>" &
        Concat(
            ForAll(
                Sequence(CountRows(data)),
                With(
                    {
                        item: Index(data, Value),
                        y: 10 + (Value - 1) * (130 / CountRows(data))
                    },
                    "<rect x='80' y='" & y & "' width='" & (item.value * 2) & "' height='" & (100 / CountRows(data)) & "' fill='" & item.color & "' rx='4'/>" &
                    "<text x='75' y='" & (y + 50 / CountRows(data) + 5) & "' text-anchor='end' font-size='12' fill='#666'>" & item.dept & "</text>" &
                    "<text x='" & (80 + item.value * 2 - 5) & "' y='" & (y + 50 / CountRows(data) + 5) & "' font-size='12' fill='#fff' font-weight='600'>" & item.value & "%</text>"
                )
            ),
            ""
        ) &
        "</svg>"
    )
)`;

                case 17: // ミニKPIカード
                    return `With(
    {
        title: "売上高",
        value: "¥842K",
        change: "+12%",
        changeLabel: "前月比"
    },
    "data:image/svg+xml," & EncodeUrl("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 180 100' width='180' height='100'><rect width='180' height='100' fill='#ffffff' rx='12' stroke='#e5e7eb' stroke-width='1'/><circle cx='30' cy='30' r='18' fill='#eff6ff'/><text x='30' y='37' text-anchor='middle' font-size='20' fill='#3b82f6'>$</text><text x='65' y='30' font-size='11' fill='#666'>" & title & "</text><text x='20' y='70' font-size='28' fill='#1a1a1a' font-weight='bold'>" & value & "</text><text x='20' y='88' font-size='11' fill='#10b981'>↑ " & change & " " & changeLabel & "</text></svg>")
)`;

                case 18: // 複数円グラフ比較
                    return `With(
    {
        year1: "2024年", percentage1: 75, color1: "#667eea",
        year2: "2025年", percentage2: 85, color2: "#10b981"
    },
    "data:image/svg+xml," & EncodeUrl("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 280 140' width='280' height='140'><circle cx='70' cy='70' r='50' fill='#f0f0f0'/><circle cx='70' cy='70' r='50' fill='none' stroke='" & color1 & "' stroke-width='25' stroke-dasharray='" & (314 * percentage1 / 100) & " 314' stroke-dashoffset='0' transform='rotate(-90 70 70)'/><text x='70' y='75' text-anchor='middle' font-size='18' font-weight='bold' fill='#1a1a1a'>" & percentage1 & "%</text><text x='70' y='135' text-anchor='middle' font-size='11' fill='#666'>" & year1 & "</text><circle cx='210' cy='70' r='50' fill='#f0f0f0'/><circle cx='210' cy='70' r='50' fill='none' stroke='" & color2 & "' stroke-width='25' stroke-dasharray='" & (314 * percentage2 / 100) & " 314' stroke-dashoffset='0' transform='rotate(-90 210 70)'/><text x='210' y='75' text-anchor='middle' font-size='18' font-weight='bold' fill='#1a1a1a'>" & percentage2 & "%</text><text x='210' y='135' text-anchor='middle' font-size='11' fill='#666'>" & year2 & "</text></svg>")
)`;

                case 19: // バッテリーインジケーター
                    return `With(
    {
        percentage: 68,
        color: "#10b981"
    },
    "data:image/svg+xml," & EncodeUrl("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 150 80' width='150' height='80'><rect x='20' y='25' width='100' height='30' fill='none' stroke='#e5e7eb' stroke-width='3' rx='4'/><rect x='120' y='32' width='8' height='16' fill='#e5e7eb' rx='2'/><rect x='24' y='29' width='" & (percentage * 0.92) & "' height='22' fill='" & color & "' rx='2'/><text x='75' y='68' text-anchor='middle' font-size='14' fill='#666' font-weight='600'>" & percentage & "%</text></svg>")
)`;

                case 21: // ダッシュボードヘッダー（ForAllで可変個数対応）
                    return `With(
    {
        kpis: Table(
            {label: "総売上", value: "¥2.4M"},
            {label: "新規顧客", value: "342"},
            {label: "契約率", value: "67%"},
            {label: "満足度", value: "4.8"}
        )
    },
    "data:image/svg+xml," & EncodeUrl(
        "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 400 80' width='400' height='80'>" &
        "<rect width='400' height='80' fill='#ffffff' rx='12' stroke='#e5e7eb' stroke-width='1'/>" &
        Concat(
            ForAll(
                Sequence(CountRows(kpis)),
                With(
                    {
                        item: Index(kpis, Value),
                        x: 20 + (Value - 1) * (380 / CountRows(kpis)),
                        divX: (Value - 1) * (400 / CountRows(kpis))
                    },
                    If(Value > 1, "<line x1='" & divX & "' y1='15' x2='" & divX & "' y2='65' stroke='#e5e7eb' stroke-width='1'/>", "") &
                    "<text x='" & x & "' y='30' font-size='11' fill='#666'>" & item.label & "</text>" &
                    "<text x='" & x & "' y='55' font-size='20' fill='#1a1a1a' font-weight='bold'>" & item.value & "</text>"
                )
            ),
            ""
        ) &
        "</svg>"
    )
)`;

                case 23: // 比較カード（vs 前年）
                    return `With(
    {
        title: "売上比較",
        year1: "2024年", value1: "¥1.8M",
        year2: "2025年", value2: "¥2.1M",
        growth: "+16.7% 成長"
    },
    "data:image/svg+xml," & EncodeUrl("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 280 140' width='280' height='140'><rect width='280' height='140' fill='#ffffff' rx='12' stroke='#e5e7eb' stroke-width='1'/><text x='20' y='30' font-size='13' fill='#666' font-weight='500'>" & title & "</text><rect x='20' y='50' width='110' height='70' fill='#f9fafb' rx='8'/><text x='75' y='70' text-anchor='middle' font-size='11' fill='#999'>" & year1 & "</text><text x='75' y='95' text-anchor='middle' font-size='24' fill='#666' font-weight='bold'>" & value1 & "</text><rect x='150' y='50' width='110' height='70' fill='#eff6ff' rx='8'/><text x='205' y='70' text-anchor='middle' font-size='11' fill='#999'>" & year2 & "</text><text x='205' y='95' text-anchor='middle' font-size='24' fill='#3b82f6' font-weight='bold'>" & value2 & "</text><rect x='95' y='125' width='90' height='10' fill='#d1fae5' rx='5'/><text x='140' y='133' text-anchor='middle' font-size='9' fill='#059669' font-weight='600'>" & growth & "</text></svg>")
)`;

                case 24: // タスク進捗カード
                    return `With(
    {
        title: "プロジェクト進捗",
        completed: 14,
        total: 20,
        inProgress: 6
    },
    "data:image/svg+xml," & EncodeUrl("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 300 120' width='300' height='120'><rect width='300' height='120' fill='#ffffff' rx='12' stroke='#e5e7eb' stroke-width='1'/><text x='20' y='25' font-size='13' fill='#666' font-weight='600'>" & title & "</text><text x='20' y='55' font-size='11' fill='#999'>完了タスク</text><rect x='20' y='62' width='260' height='12' fill='#f0f0f0' rx='6'/><rect x='20' y='62' width='" & (260 * completed / total) & "' height='12' fill='#10b981' rx='6'/><text x='280' y='72' text-anchor='end' font-size='11' fill='#1a1a1a' font-weight='600'>" & completed & "/" & total & "</text><circle cx='25' cy='95' r='4' fill='#10b981'/><text x='35' y='99' font-size='11' fill='#666'>完了: " & completed & "件</text><circle cx='125' cy='95' r='4' fill='#667eea'/><text x='135' y='99' font-size='11' fill='#666'>進行中: " & inProgress & "件</text></svg>")
)`;

                case 28: // 統計サマリーカード
                    return `With(
    {
        title: "総アクセス数",
        value: "12.5K",
        change: "+8.3%",
        changeCount: "962",
        changeLabel: "前日比"
    },
    "data:image/svg+xml," & EncodeUrl("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 220 110' width='220' height='110'><rect width='220' height='110' fill='#ffffff' rx='12' stroke='#e5e7eb' stroke-width='1'/><rect x='15' y='15' width='40' height='40' fill='#f0fdf4' rx='8'/><text x='35' y='42' text-anchor='middle' font-size='24' fill='#10b981'>↑</text><text x='65' y='28' font-size='12' fill='#999'>" & title & "</text><text x='65' y='55' font-size='26' fill='#1a1a1a' font-weight='bold'>" & value & "</text><rect x='15' y='70' width='190' height='25' fill='#f9fafb' rx='6'/><text x='22' y='86' font-size='11' fill='#666'>" & changeLabel & "</text><text x='198' y='86' text-anchor='end' font-size='11' fill='#10b981' font-weight='600'>" & change & " (" & changeCount & ")</text></svg>")
)`;

                case 29: // 目標達成メーター
                    return `With(
    {
        percentage: 80,
        achieved: "¥800K",
        target: "¥1,000K",
        title: "月次目標"
    },
    "data:image/svg+xml," & EncodeUrl("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 140' width='200' height='140'><text x='100' y='20' text-anchor='middle' font-size='13' fill='#666' font-weight='600'>" & title & "</text><rect x='30' y='40' width='140' height='30' fill='#f0f0f0' rx='15'/><rect x='30' y='40' width='" & (140 * percentage / 100) & "' height='30' fill='#10b981' rx='15'/><text x='100' y='61' text-anchor='middle' font-size='14' fill='#fff' font-weight='bold'>" & percentage & "%</text><text x='100' y='100' text-anchor='middle' font-size='12' fill='#999'>達成額</text><text x='100' y='120' text-anchor='middle' font-size='20' fill='#1a1a1a' font-weight='bold'>" & achieved & "</text><text x='100' y='135' text-anchor='middle' font-size='10' fill='#999'>/ " & target & "</text></svg>")
)`;

                case 27: // ヒートマップ風カレンダー（Sequenceで可変個数対応）
                    return `With(
    {
        // 活動データ: 0-4の5段階（0=活動なし、4=最高活動量）
        activityData: [
            [0, 2, 3, 0, 4, 2, 0],
            [3, 0, 2, 3, 2, 0, 4]
        ],
        colors: ["#ebedf0", "#9be9a8", "#40c463", "#30a14e", "#216e39"]
    },
    "data:image/svg+xml," & EncodeUrl(
        "<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 280 80' width='280' height='80'>" &
        "<text x='5' y='15' font-size='11' fill='#666'>活動記録</text>" &
        Concat(
            ForAll(
                Sequence(CountRows(activityData)),
                With(
                    {rowIndex: Value, row: Index(activityData, Value)},
                    Concat(
                        ForAll(
                            Sequence(CountRows(row)),
                            With(
                                {
                                    colIndex: Value,
                                    activity: Index(row, Value),
                                    x: 10 + (colIndex - 1) * 16,
                                    y: 25 + (rowIndex - 1) * 16
                                },
                                "<rect x='" & x & "' y='" & y & "' width='12' height='12' fill='" & Index(colors, activity + 1) & "' rx='2'/>"
                            )
                        ),
                        ""
                    )
                )
            ),
            ""
        ) &
        "<rect x='135' y='30' width='8' height='8' fill='" & Index(colors, 1) & "' rx='2'/>" &
        "<text x='148' y='37' font-size='9' fill='#999'>少</text>" &
        Concat(ForAll(Sequence(4), "<rect x='" & (170 + (Value - 1) * 13) & "' y='30' width='8' height='8' fill='" & Index(colors, Value + 1) & "' rx='2'/>"), "") &
        "<text x='222' y='37' font-size='9' fill='#999'>多</text>" &
        "</svg>"
    )
)`;

                case 30: // リアルタイムカウンター
                    return `With(
    {
        title: "オンラインユーザー",
        count: "1,847"
    },
    "data:image/svg+xml," & EncodeUrl("<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 250 120' width='250' height='120'><rect width='250' height='120' fill='#1a1a1a' rx='12'/><text x='20' y='35' font-size='13' fill='#999' font-weight='500'>" & title & "</text><text x='20' y='75' font-size='48' fill='#10b981' font-weight='bold' font-family='monospace'>" & count & "</text><circle cx='215' cy='30' r='8' fill='#10b981'/><text x='230' y='35' font-size='11' fill='#10b981' font-weight='600'>LIVE</text><text x='20' y='100' font-size='11' fill='#666'>最終更新: たった今</text></svg>")
)`;

                // 数値を扱わないサンプルはシンプルなコードを返す
                default:
                    return `"data:image/svg+xml," & EncodeUrl("${cleanSvg(svgCode)}")`;
            }
        }

        // モーダルを閉じる
        function closeModal() {
            document.getElementById('modal').classList.remove('show');
            document.body.style.overflow = 'auto';
        }

        // SVGコードをコピー
        function copySvgCode() {
            const code = document.getElementById('modalCode').textContent;
            navigator.clipboard.writeText(code).then(() => {
                showCopyNotification('SVGコードをコピーしました');
            });
        }

        // Power Apps用コードをコピー
        function copyPowerAppsCode() {
            const code = document.getElementById('modalPowerAppsCode').textContent;
            navigator.clipboard.writeText(code).then(() => {
                showCopyNotification('Power Apps用コードをコピーしました');
            });
        }

        // コピー通知
        function showCopyNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'fixed bottom-8 right-8 bg-gray-900 text-white px-6 py-3 rounded-lg shadow-lg z-50 flex items-center gap-2';
            notification.innerHTML = `
                <span class="material-symbols-rounded text-[20px]">check_circle</span>
                ${message}
            `;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
    </script>
</body>
</html>
